<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="google-adsense-account" content="ca-pub-9952387808707527">
    <title>Court Mate - Smart AI Agent</title>

    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon_192.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.prod.min.js"></script>

    <!-- Tournament Data -->
    <!-- Tournament Data (Moved to root for reliability) -->
    <script defer src="2026_tournaments.js"
        onerror="alert('Error: 2026_tournaments.js failed to load. Please ensure the file is in the same directory as index.html.'); console.error('Failed to load 2026_tournaments.js');"></script>
    <!-- tournaments.js removed to prevent data conflict -->

    <!-- ‚úÖ ÏàòÏ†ï: ÏóêÎü¨ Ï≤òÎ¶¨ Ï∂îÍ∞Ä & Minified Version -->
    <script defer src="rankings_data.js?v=20260211" onerror="console.error('Failed to load rankings_data.js')"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;600;800&family=Noto+Sans+KR:wght@400;700&family=Noto+Sans+SC:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9952387808707527"
        crossorigin="anonymous"></script>

    <script data-noptimize="1" data-cfasync="false" data-wpfc-render="false">
        (function () {
            var script = document.createElement("script");
            script.async = 1;
            script.src = 'https://emrld.cc/NDk3NDMy.js?t=497432';
            document.head.appendChild(script);
        })();
    </script>

    <style>
        /* --- [Core] CSS Variables & Reset --- */
        :root {
            --primary: #10B981;
            --primary-dark: #059669;
            --slate-900: #0f172a;
            --slate-800: #1e293b;
            --slate-700: #334155;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --white: #ffffff;

            /* Status Colors */
            --color-mandatory: #7e22ce;
            --color-main: #10b981;
            --color-qual: #eab308;
            --color-promo: #f59e0b;
            --color-reserve: #9ca3af;

            /* Transitions */
            --pastel-green: #6ee7b7;
            --pastel-blue: #93c5fd;
            --pastel-indigo: #a5b4fc;
            --pastel-purple: #d8b4fe;
            --pastel-teal: #5eead4;

            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--gray-100);
            font-family: 'Inter', 'Noto Sans KR', 'Noto Sans SC', 'Noto Sans JP', sans-serif;
            color: var(--slate-900);
            font-size: 14px;
        }

        [v-cloak] {
            display: none !important;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button,
        input,
        select,
        textarea {
            font-family: inherit;
            outline: none;
        }

        /* --- [Layout] App Container --- */
        .app-container {
            max-width: 480px;
            width: 100%;
            margin: 0 auto;
            background-color: var(--white);
            min-height: 100vh;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow-x: hidden;
        }

        .flex-1 {
            flex: 1;
        }

        .p-4 {
            padding: 1rem;
        }

        .p-5 {
            padding: 1.25rem;
        }

        .p-6 {
            padding: 1rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .text-center {
            text-align: center;
        }

        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .flex-center {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        /* ‚úÖ NEW: 4-Column Grid for Compact Buttons */
        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.25rem;
        }

        .grid-4 .action-btn {
            flex-direction: column;
            padding: 6px 2px;
            font-size: 0.55rem;
            gap: 3px;
            text-align: center;
            height: 100%;
            justify-content: center;
            line-height: 1.1;
        }

        .grid-4 .action-btn i {
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        /* --- [Components] UI Elements --- */
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem;
            border-radius: 0.75rem;
            font-weight: 700;
            font-size: 0.875rem;
            cursor: pointer;
            transition: transform 0.1s, opacity 0.2s;
            border: none;
            width: 100%;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--slate-800);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-emerald {
            background: var(--primary);
            color: white;
        }

        .btn-ghost {
            background: var(--white);
            border: 1px solid var(--gray-200);
            color: var(--slate-700);
        }

        .card {
            background: white;
            border-radius: 1rem;
            padding: 1rem;
            border: 1px solid var(--gray-100);
            box-shadow: var(--shadow);
            margin-bottom: 1rem;
        }

        .label {
            display: block;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--gray-500);
            margin-bottom: 0.25rem;
            text-transform: uppercase;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid var(--gray-200);
            background: var(--gray-50);
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        input:focus,
        select:focus {
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 2px var(--pastel-green);
            outline: none;
        }

        /* ‚úÖ Ï∂îÍ∞Ä: ÏûÖÎ†• ÏóêÎü¨ Ïä§ÌÉÄÏùº */
        input.error {
            border-color: #ef4444;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.65rem;
            margin-top: 0.25rem;
        }

        /* --- [Feature] Branding --- */
        .brand-text {
            font-family: 'Pacifico', cursive;
            font-size: 1.75rem;
            line-height: 1;
            color: var(--primary);
            transition: color 0.5s ease;
        }

        .text-pastel-green {
            color: var(--pastel-green);
        }

        .inline-header-container {
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .brand-text-center {
            text-align: center;
            justify-self: center;
        }

        /* Dark Mode Toggle Button */
        .dark-mode-toggle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--gray-200);
            background: var(--white);
            color: var(--slate-700);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }

        .dark-mode-toggle:hover {
            background: var(--gray-50);
            transform: scale(1.05);
        }

        .dark-mode-toggle:active {
            transform: scale(0.95);
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #0f172a;
            color: #e2e8f0;
        }

        body.dark-mode .app-container {
            background-color: #1e293b;
        }

        body.dark-mode .card {
            background: #334155;
            border-color: #475569;
        }

        body.dark-mode input[type="text"],
        body.dark-mode input[type="number"],
        body.dark-mode select {
            background: #1e293b;
            border-color: #475569;
            color: #e2e8f0;
        }

        body.dark-mode .btn-primary {
            background: #0ea5e9;
        }

        body.dark-mode .global-footer-bar {
            background: #1e293b;
            border-color: #475569;
        }

        body.dark-mode .dark-mode-toggle {
            background: #475569;
            border-color: #64748b;
            color: #fbbf24;
        }

        /* Dark Mode: Inner Rectangles */
        body.dark-mode .sim-toggle,
        body.dark-mode .filter-panel,
        body.dark-mode .res-card,
        body.dark-mode .search-item,
        body.dark-mode .action-btn {
            background: #1e293b !important;
            border-color: #475569 !important;
            color: #e2e8f0 !important;
        }

        body.dark-mode .sim-toggle-btn.active {
            background: #334155 !important;
            color: #fff !important;
            box-shadow: none !important;
        }

        body.dark-mode .sim-toggle-btn {
            color: #94a3b8 !important;
        }

        body.dark-mode .filter-chip {
            background: #1e293b;
            border-color: #475569;
            color: #cbd5e1;
        }

        body.dark-mode .filter-chip:hover {
            background: #334155;
            border-color: #64748b;
        }

        body.dark-mode .filter-chip.active {
            background: var(--primary) !important;
            color: white !important;
            border-color: var(--primary) !important;
        }

        body.dark-mode label,
        body.dark-mode .label,
        body.dark-mode .filter-label,
        body.dark-mode h3,
        body.dark-mode h4 {
            color: #e2e8f0 !important;
        }

        body.dark-mode .fa-circle-info,
        body.dark-mode .fa-plane-departure,
        body.dark-mode .fa-user-group,
        body.dark-mode .fa-lightbulb {
            color: #94a3b8 !important;
        }

        body.dark-mode .plan-circuit-input {
            background: #334155 !important;
            color: white !important;
        }

        body.dark-mode footer p {
            color: #94a3b8 !important;
        }

        /* Dark Mode: Specific containers with inline styles override */
        body.dark-mode div[style*="background:#eff6ff"],
        body.dark-mode div[style*="background:var(--gray-50)"],
        body.dark-mode div[style*="background:white"] {
            background: #1e293b !important;
            border-color: #475569 !important;
            color: #e2e8f0 !important;
        }

        /* Exception for primary colored elements inside */
        body.dark-mode div[style*="background:#eff6ff"] p,
        body.dark-mode div[style*="background:var(--gray-50)"] p {
            color: #e2e8f0 !important;
        }

        /* Dark Mode: Input Sections & Calc Options */
        body.dark-mode .input-section {
            background: #1e293b !important;
            border-color: #475569 !important;
            color: #e2e8f0 !important;
        }

        body.dark-mode .calc-option {
            background: #1e293b !important;
            border-color: #475569 !important;
            color: #e2e8f0 !important;
        }

        body.dark-mode .calc-option p {
            color: #94a3b8 !important;
        }

        /* --- [Feature] Global Footer & Safety Warning (Unified) --- */
        .unified-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            background: var(--white);
            z-index: 200;
            border-top: 1px solid var(--gray-200);
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.05);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .global-footer-bar {
            /* Removed fixed positioning */
            width: 100%;
            height: 3rem;
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            align-items: center;
            background: var(--white);
            /* border-top moved to container */
        }

        .footer-col {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--slate-700);
            cursor: pointer;
        }

        .footer-brand {
            font-family: 'Pacifico', cursive;
            font-size: 1.1rem;
            color: #1974D2;
            cursor: default;
        }

        .footer-col:not(.footer-brand):active {
            background: var(--gray-50);
        }

        /* Safety Warning Footer (Inside Unified) */
        .safety-warning-footer {
            /* Removed fixed positioning */
            width: 100%;
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border-top: 2px solid #dc2626;
            /* Slightly thinner border */
            padding: 0.5rem 1rem;
            text-align: center;
        }

        .safety-warning-text {
            font-size: 0.7rem;
            font-weight: 800;
            color: #991b1b;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            line-height: 1.4;
        }

        .safety-warning-icon {
            color: #dc2626;
            margin-right: 0.5rem;
            font-size: 0.9rem;
        }

        /* --- [Feature] Simulator --- */
        .sim-toggle {
            display: flex;
            background: var(--gray-100);
            padding: 4px;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .sim-toggle-btn {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: 0.375rem;
            font-weight: 700;
            font-size: 0.75rem;
            cursor: pointer;
            color: var(--gray-400);
            background: transparent;
        }

        .sim-toggle-btn.active {
            background: white;
            color: var(--slate-900);
            box-shadow: var(--shadow);
        }

        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--slate-700);
            cursor: pointer;
        }

        .radio-item input {
            width: auto;
            margin: 0;
            accent-color: var(--primary);
        }

        .res-card {
            padding: 0.75rem;
            border-left: 4px solid var(--gray-400);
            border-radius: 0.5rem;
            background: white;
            margin-bottom: 0.5rem;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .res-grade {
            display: inline-block;
            font-size: 0.65rem;
            font-weight: 800;
            padding: 2px 6px;
            border-radius: 4px;
            background: var(--slate-700);
            color: white;
            margin-bottom: 4px;
            margin-right: 4px;
        }

        .action-btn {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            padding: 6px;
            border-radius: 6px;
            font-size: 0.65rem;
            font-weight: 700;
            color: var(--gray-500);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        /* --- Animations --- */
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- Modals & Share --- */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .social-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            width: 100%;
        }

        .social-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.8rem;
            border: none;
            cursor: pointer;
            color: white;
        }

        .share-sticky-btn {
            position: fixed;
            bottom: calc(5.5rem + env(safe-area-inset-bottom));
            right: 1.5rem;
            width: 3.5rem;
            height: 3.5rem;
            border-radius: 50%;
            background: var(--slate-800);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            box-shadow: var(--shadow-lg);
            z-index: 90;
            cursor: pointer;
            border: none;
            transition: transform 0.2s;
        }

        .share-sticky-btn:active {
            transform: scale(0.9);
        }

        .search-item {
            cursor: pointer;
            transition: background-color 0.15s;
        }

        .search-item:hover {
            background-color: var(--gray-50);
        }

        /* ‚úÖ Ï∂îÍ∞Ä: Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏóêÎü¨ ÏïåÎ¶º */
        .data-error {
            background: #fee2e2;
            border: 1px solid #ef4444;
            color: #991b1b;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.75rem;
        }

        /* ‚úÖ NEW: Tournament Filter Panel */
        .filter-panel {
            background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
            border: 1px solid var(--gray-200);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .filter-section {
            margin-bottom: 0.75rem;
        }

        .filter-section:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            font-size: 0.7rem;
            font-weight: 700;
            color: var(--gray-500);
            text-transform: uppercase;
            margin-bottom: 0.5rem;
            display: block;
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .filter-chip {
            padding: 0.3rem 0.6rem;
            border-radius: 999px;
            font-size: 0.65rem;
            font-weight: 600;
            border: 1.5px solid var(--gray-300);
            background: white;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .filter-chip:hover {
            border-color: var(--primary);
            background: var(--gray-50);
        }

        .filter-chip.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* ‚úÖ NEW: Countdown Timer */
        .timer-container {
            text-align: center;
            padding: 1rem;
            margin-top: 1rem;
        }

        .timer-display {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-family: 'Inter', monospace;
        }

        .timer-label {
            font-size: 0.7rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* ‚úÖ NEW: Player Advice Message */
        .player-advice {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            margin-top: 0.75rem;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.2);
        }

        .player-advice-text {
            font-size: 0.7rem;
            font-weight: 700;
            color: #92400e;
            line-height: 1.5;
        }

        /* ‚úÖ NEW: Tournament Selection Checkboxes */
        .tournament-checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
            margin-right: 0.5rem;
        }

        .selected-tournament-card {
            box-shadow: 0 0 0 3px var(--pastel-green);
            background: linear-gradient(to right, #f0fdf4, white);
        }

        .plan-circuit-container {
            position: fixed;
            bottom: calc(8rem + env(safe-area-inset-bottom));
            left: 50%;
            transform: translateX(-50%);
            max-width: 440px;
            width: calc(100% - 3rem);
            z-index: 100;
            animation: slideUp 0.3s ease-out;
            background: white;
            padding: 0.4rem;
            border-radius: 999px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: flex;
            gap: 0.5rem;
            border: 1px solid #10b981;
        }

        .plan-circuit-input {
            flex: 1;
            border: none;
            outline: none;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            border-radius: 999px;
            background: #f3f4f6;
            color: #1f2937;
        }

        .plan-circuit-input::placeholder {
            color: #9ca3af;
            font-size: 0.8rem;
        }

        .plan-circuit-action-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 0.5rem 1.25rem;
            border-radius: 999px;
            font-weight: 700;
            font-size: 0.875rem;
            cursor: pointer;
            white-space: nowrap;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .plan-circuit-action-btn:active {
            transform: scale(0.95);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Multi-Tournament Selection */
        .tournament-card-wrapper {
            position: relative;
            transition: all 0.2s ease;
        }

        .tournament-card-wrapper.selected {
            box-shadow: 0 0 0 3px var(--pastel-green);
            border-radius: 0.5rem;
        }

        .tournament-checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            user-select: none;
        }
    </style>
</head>

<body>
    <div id="app" class="app-container" v-cloak>
        <!--  NEW: Circuit Planner Modal -->




        <div class="flex-1" style="overflow-y:auto; padding-bottom:10.5rem;">
            <div class="p-6">
                <div class="inline-header-container">
                    <button @click="toggleDarkMode" class="dark-mode-toggle"
                        :title="darkMode ? 'Light Mode' : 'Dark Mode'">
                        <i :class="darkMode ? 'fa-solid fa-sun' : 'fa-solid fa-moon'"></i>
                    </button>
                    <h1 class="brand-text text-pastel-green brand-text-center">Court Mate</h1>
                    <select v-model="currentLang"
                        style="width: 80px; padding:4px; border-radius:99px; font-size:11px; font-weight:700;">
                        <option value="en">üá∫üá∏ English</option>
                        <option value="ko">üá∞üá∑ ÌïúÍµ≠Ïñ¥</option>
                        <option value="zh">üá®üá≥ ‰∏≠Êñá</option>
                        <option value="ja">üáØüáµ Êó•Êú¨Ë™û</option>
                    </select>
                </div>

                <!-- ‚úÖ Ï∂îÍ∞Ä: Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå® Í≤ΩÍ≥† -->
                <div v-if="dataLoadError" class="data-error">
                    <i class="fa-solid fa-triangle-exclamation"></i> {{ t('dataLoadError') }}
                </div>

                <div class="card animate-fade-in">
                    <div class="mb-2 relative"
                        style="border-bottom:1px solid var(--gray-100); padding-bottom:0.75rem; margin-bottom:0.75rem;">
                        <div class="flex-between mb-2">
                            <label class="label" style="margin-bottom:0;">{{ t('searchTitle') }}</label>
                            <div style="display:flex; align-items:center; gap:0.5rem;">
                                <label
                                    style="display:flex; align-items:center; gap:4px; cursor:pointer; user-select:none;">
                                    <input type="checkbox" v-model="rememberPlayer"
                                        style="width:13px; height:13px; margin:0; accent-color:var(--primary); cursor:pointer;">
                                    <span
                                        style="font-size:0.65rem; color:var(--gray-500); font-weight:700; text-transform:uppercase; letter-spacing:0.02em;">{{
                                        t('searchRememberMe') }}</span>
                                </label>
                                <span style="font-size:0.65rem; color:var(--primary); cursor:pointer; margin-left:4px;"
                                    @click="clearSearch" v-if="searchQuery">{{ t('searchClear') }}</span>
                            </div>
                        </div>
                        <div style="position:relative;">
                            <input type="text" v-model="searchQuery" @focus="showSearchResults = true"
                                @input="showSearchResults = true" :placeholder="t('searchPlaceholder')"
                                style="padding-left: 2.25rem;" aria-label="Search players">
                            <i class="fa-solid fa-magnifying-glass"
                                style="position:absolute; left:1rem; top:50%; transform:translateY(-50%); color:var(--gray-400);"></i>
                        </div>


                        <!-- ‚úÖ NEW: Search Hint (Attached to Input) -->
                        <p
                            style="font-size:0.65rem; color:var(--gray-500); margin-top:4px; margin-left:4px; margin-bottom:0.5rem; line-height:1.2;">
                            <i class="fa-solid fa-circle-info" style="margin-right:2px;"></i> {{ t('searchHint') }}
                        </p>

                        <!-- ‚úÖ ÏàòÏ†ï: Í≤ÄÏÉâ Í≤∞Í≥º ÌëúÏãú Í∞úÏÑ† -->
                        <div v-if="searchQuery && showSearchResults && searchResults.length > 0"
                            style="background:white; border:1px solid var(--gray-200); border-radius:0.5rem; margin-top:4px; margin-bottom:1rem; box-shadow:var(--shadow); width:100%; max-height: 300px; overflow-y: auto;">
                            <div v-for="p in searchResults" :key="p.id + p.category" @click="selectPlayer(p)"
                                class="search-item"
                                style="padding:0.75rem; border-bottom:1px solid var(--gray-100); cursor:pointer; display:flex; justify-content:space-between; align-items:center;"
                                role="button" tabindex="0" @keydown.enter="selectPlayer(p)">
                                <div>
                                    <div style="font-weight:700; font-size:0.8rem;">{{ p.name }}</div>
                                    <div style="font-size:0.65rem; color:var(--gray-500);">{{ p.country }} ‚Ä¢ {{
                                        p.category }} #{{ p.rank }}</div>
                                </div>
                                <div style="font-weight:700; font-size:0.75rem; color:var(--primary);">{{
                                    formatPoints(p.points) }} pts</div>
                            </div>
                        </div>
                        <div v-else-if="searchQuery && showSearchResults"
                            style="background:white; border:1px solid var(--gray-200); border-radius:0.5rem; margin-top:4px; padding:0.75rem; text-align:center; color:var(--gray-500); font-size:0.75rem;">
                            {{ t('noPlayersFound') }}
                        </div>
                    </div>


                    <div class="flex-between mb-2">
                        <h3 style="font-weight:700; color:var(--slate-800); font-size:0.875rem;"><i
                                class="fa-solid fa-plane-departure" style="color:#3B82F6; margin-right:6px;"></i> {{
                            t('simTitle') }}</h3>
                    </div>

                    <div class="sim-toggle">
                        <button @click="sim.type = 'singles'" class="sim-toggle-btn"
                            :class="{active: sim.type === 'singles'}">{{ t('simSingles') }}</button>
                        <button @click="sim.type = 'doubles'" class="sim-toggle-btn"
                            :class="{active: sim.type === 'doubles'}">{{ t('simDoubles') }}</button>
                    </div>

                    <div class="input-section"
                        style="background:#eff6ff; padding:0.75rem; border-radius:0.75rem; border:1px solid #dbeafe; margin-bottom:0.75rem;">
                        <p style="font-size:10px; font-weight:700; color:#3b82f6; margin-bottom:0.5rem;"><i
                                class="fa-solid fa-circle-info mr-1"></i> {{ t('playerInfo') }}</p>
                        <div class="radio-group">
                            <template v-if="sim.type === 'singles'">
                                <label class="radio-item"><input type="radio" v-model="sim.guestEvent" value="MS">
                                    MS</label>
                                <label class="radio-item"><input type="radio" v-model="sim.guestEvent" value="WS">
                                    WS</label>
                            </template>
                            <template v-else>
                                <label class="radio-item"><input type="radio" v-model="sim.guestEvent" value="MD">
                                    MD</label>
                                <label class="radio-item"><input type="radio" v-model="sim.guestEvent" value="WD">
                                    WD</label>
                                <label class="radio-item"><input type="radio" v-model="sim.guestEvent" value="XD">
                                    XD</label>
                            </template>
                        </div>
                        <div class="grid-2">
                            <div>
                                <input v-model.number="sim.guestPoints" type="number" :placeholder="t('rankPoints')"
                                    :class="{'error': validationErrors.points}" min="0" max="999999"
                                    @input="validateInputs">
                                <p v-if="validationErrors.points" class="error-message">{{ validationErrors.points }}
                                </p>
                            </div>
                            <div>
                                <input v-model.number="sim.currentRank" type="number" :placeholder="t('currentRank')"
                                    :class="{'error': validationErrors.rank}" min="1" max="100000"
                                    @input="validateInputs">
                                <p v-if="validationErrors.rank" class="error-message">{{ validationErrors.rank }}</p>
                            </div>
                        </div>
                    </div>

                    <div v-if="sim.type === 'doubles'" class="input-section"
                        style="background:var(--gray-50); padding:0.75rem; border-radius:0.75rem; border:1px solid var(--gray-200); margin-bottom:0.75rem;">
                        <p style="font-size:10px; font-weight:700; color:var(--gray-500); margin-bottom:0.5rem;">
                            <i class="fa-solid fa-user-group mr-1"></i> {{ t('partnerPoints') }}
                            <span style="color:var(--gray-400); font-weight:400;">({{ t('optional') }})</span>
                        </p>
                        <div>
                            <input v-model.number="sim.partnerPoints" type="number"
                                :placeholder="t('partnerPointsPlaceholder')" class="mb-4"
                                :class="{'error': validationErrors.partnerPoints}" min="0" max="999999"
                                @input="validateInputs">
                            <p v-if="validationErrors.partnerPoints" class="error-message">{{
                                validationErrors.partnerPoints }}</p>
                        </div>
                        <p v-if="t('partnerPointsHint')"
                            style="font-size:0.6rem; color:var(--gray-400); margin-bottom:0.75rem;">
                            <i class="fa-solid fa-lightbulb"></i> {{ t('partnerPointsHint') }}
                        </p>
                        <div style="border-top:1px solid var(--gray-200); padding-top:0.75rem;">
                            <label class="label">{{ t('simCalcMethod') }}</label>

                            <div @click="sim.calcMethod = 'normal'" class="calc-option"
                                style="background:white; border:1px solid; border-radius:0.5rem; padding:0.75rem; margin-bottom:0.5rem; cursor:pointer;"
                                :style="sim.calcMethod === 'normal' ? 'border-color:#3b82f6; box-shadow:0 0 0 1px #3b82f6;' : 'border-color:var(--gray-200);'">
                                <div class="flex-between mb-1"><span style="font-size:0.75rem; font-weight:700;">{{
                                        t('normal') }}</span>
                                    <div style="width:12px; height:12px; border-radius:50%; border:1px solid var(--gray-300);"
                                        :style="sim.calcMethod === 'normal' ? 'background:#3b82f6; border-color:#3b82f6;' : ''">
                                    </div>
                                </div>
                                <p style="font-size:0.65rem; color:var(--gray-400);">{{ t('normalDesc') }}</p>
                            </div>

                            <div @click="sim.calcMethod = 'notional'" class="calc-option"
                                style="background:white; border:1px solid; border-radius:0.5rem; padding:0.75rem; margin-bottom:0.5rem; cursor:pointer;"
                                :style="sim.calcMethod === 'notional' ? 'border-color:#3b82f6; box-shadow:0 0 0 1px #3b82f6;' : 'border-color:var(--gray-200);'">
                                <div class="flex-between mb-1"><span style="font-size:0.75rem; font-weight:700;">{{
                                        t('simNotionalTitle') }}</span>
                                    <div style="width:12px; height:12px; border-radius:50%; border:1px solid var(--gray-300);"
                                        :style="sim.calcMethod === 'notional' ? 'background:#3b82f6; border-color:#3b82f6;' : ''">
                                    </div>
                                </div>
                                <p style="font-size:0.65rem; color:var(--gray-400);">{{ t('simNotionalDetail') }}</p>
                            </div>

                            <div @click="sim.calcMethod = 'adjusted'" class="calc-option"
                                style="background:white; border:1px solid; border-radius:0.5rem; padding:0.75rem; cursor:pointer;"
                                :style="sim.calcMethod === 'adjusted' ? 'border-color:#3b82f6; box-shadow:0 0 0 1px #3b82f6;' : 'border-color:var(--gray-200);'">
                                <div class="flex-between mb-1"><span style="font-size:0.75rem; font-weight:700;">{{
                                        t('simAdjustedTitle') }}</span>
                                    <div style="width:12px; height:12px; border-radius:50%; border:1px solid var(--gray-300);"
                                        :style="sim.calcMethod === 'adjusted' ? 'background:#3b82f6; border-color:#3b82f6;' : ''">
                                    </div>
                                </div>
                                <select v-if="sim.calcMethod === 'adjusted'" v-model="sim.playedCount" @click.stop
                                    style="font-size:0.65rem; padding:4px; margin-top:4px;">
                                    <option value="5">{{ t('simOpt5') }}</option>
                                    <option value="6">{{ t('simOpt6') }}</option>
                                    <option value="7">{{ t('simOpt7') }}</option>
                                    <option value="8">{{ t('simOpt8') }}</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- ‚úÖ NEW: Tournament Filter Panel -->
                    <div class="filter-panel" v-if="!sim.loading" style="padding: 0.75rem; margin-bottom: 0.75rem;">
                        <div class="filter-section">
                            <span class="filter-label">{{ t('filterRegion') }}</span>
                            <div class="filter-chips">
                                <div class="filter-chip" :class="{active: filters.selectedRegions.length === 0}"
                                    @click="filters.selectedRegions = []">{{ t('filterAll') }}</div>
                                <div class="filter-chip" :class="{active: filters.selectedRegions.includes('Asia')}"
                                    @click="toggleRegionFilter('Asia')">{{ t('regionAsia') }}</div>
                                <div class="filter-chip" :class="{active: filters.selectedRegions.includes('Europe')}"
                                    @click="toggleRegionFilter('Europe')">{{ t('regionEurope') }}</div>
                                <div class="filter-chip" :class="{active: filters.selectedRegions.includes('PanAm')}"
                                    @click="toggleRegionFilter('PanAm')">{{ t('regionPanAm') }}</div>
                                <div class="filter-chip" :class="{active: filters.selectedRegions.includes('Africa')}"
                                    @click="toggleRegionFilter('Africa')">{{ t('regionAfrica') }}</div>
                                <div class="filter-chip" :class="{active: filters.selectedRegions.includes('Oceania')}"
                                    @click="toggleRegionFilter('Oceania')">{{ t('regionOceania') }}</div>
                            </div>
                        </div>
                        <div class="filter-section">
                            <span class="filter-label">{{ t('filterGrade') }}</span>
                            <div class="filter-chips">
                                <div class="filter-chip" :class="{active: filters.selectedGrades.length === 0}"
                                    @click="filters.selectedGrades = []">{{ t('filterAll') }}</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('S1000')}"
                                    @click="toggleGradeFilter('S1000')">Super 1000</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('S750')}"
                                    @click="toggleGradeFilter('S750')">Super 750</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('S500')}"
                                    @click="toggleGradeFilter('S500')">Super 500</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('S300')}"
                                    @click="toggleGradeFilter('S300')">Super 300</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('S100')}"
                                    @click="toggleGradeFilter('S100')">Super 100</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('IC')}"
                                    @click="toggleGradeFilter('IC')">Int. Challenge</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('IS')}"
                                    @click="toggleGradeFilter('IS')">Int. Series</div>
                                <div class="filter-chip" :class="{active: filters.selectedGrades.includes('Junior')}"
                                    @click="toggleGradeFilter('Junior')">Junior</div>
                            </div>
                        </div>
                    </div>

                    <button @click="runSimulation" class="btn btn-primary" :disabled="sim.loading || !isFormValid"
                        :title="!isFormValid ? t('fillRequiredFields') : ''">
                        <span v-if="!sim.loading">{{ t('simBtnRun') }}</span>
                        <span v-else>{{ t('simAnalyzing') }}</span>
                    </button>

                    <!-- ‚úÖ NEW: Log-Based Loading Screen -->
                    <div v-if="sim.loading"
                        style="margin-top:1rem; background:linear-gradient(135deg, #f0fdf4, #dcfce7); border:1px solid #86efac; border-radius:0.75rem; padding:1rem;"
                        class="animate-fade-in">
                        <div style="margin-bottom:0.75rem; text-align:center;">
                            <div
                                style="font-size:0.7rem; font-weight:700; color:#059669; text-transform:uppercase; letter-spacing:0.05em;">
                                AI Analysis in Progress</div>
                        </div>
                        <div v-for="(log, index) in loadingLogs" :key="index"
                            style="display:flex; align-items:center; gap:0.5rem; padding:0.4rem 0; font-size:0.7rem;">
                            <i :class="log.done ? 'fa-solid fa-check-circle' : 'fa-solid fa-spinner fa-spin'"
                                :style="{color: log.done ? '#10b981' : '#6b7280'}"></i>
                            <span
                                :style="{color: log.done ? '#059669' : '#6b7280', fontWeight: log.done ? '600' : '400'}">{{
                                log.message }}</span>
                        </div>
                        <div
                            style="margin-top:0.75rem; background:white; border-radius:0.5rem; height:6px; overflow:hidden;">
                            <div
                                :style="{width: loadingProgress + '%', height:'100%', background:'linear-gradient(90deg, #10b981, #059669)', transition:'width 0.3s ease'}">
                            </div>
                        </div>
                    </div>

                    <!-- ‚úÖ NEW: Player Advice Message (Replaced with AMA Logo) -->
                    <div v-if="sim.loading" class="animate-fade-in" style="margin-top: 0.75rem; text-align: center;">
                        <img src="ama_logo_2.png" alt="AMA Logo" style="width: 100%; max-width: 150px; height: auto;">
                    </div>

                    <!-- ‚úÖ Ï∂îÍ∞Ä: Î≤ÑÌäºÏù¥ ÎπÑÌôúÏÑ±ÌôîÎêú Ïù¥Ïú† ÌëúÏãú -->
                    <p v-if="!isFormValid && !sim.loading"
                        style="font-size:0.65rem; color:#ef4444; margin-top:0.5rem; text-align:center;">
                        <i class="fa-solid fa-circle-info"></i> {{ getValidationMessage() }}
                    </p>

                    <div v-if="sim.results"
                        style="margin-top:1rem; padding-top:0.75rem; border-top:1px solid var(--gray-100);"
                        class="animate-fade-in">
                        <div class="flex-between mb-2" style="align-items: center; position: relative;">
                            <span style="font-size:0.75rem; font-weight:700; color:var(--gray-500);">{{
                                t('simResultTitle') }}</span>

                            <!-- ‚úÖ NEW: Share Button (Absolute Center) -->
                            <button @click="shareResults"
                                style="background:none; border:none; cursor:pointer; color:var(--primary); font-size:0.9rem; padding:0.25rem; font-weight:700; position:absolute; left:50%; transform:translateX(-50%); white-space:nowrap;">
                                <i class="fa-solid fa-share-nodes"></i> {{ t('share') }}
                            </button>

                            <span @click="showNoticeModal = true"
                                style="font-size:0.65rem; font-weight:700; color:var(--gray-500); cursor:pointer; text-decoration:underline;">Notice
                                <i class="fa-solid fa-circle-info"></i></span>
                        </div>

                        <div v-if="filteredResults.length === 0"
                            style="text-align:center; padding:2rem; color:var(--gray-500); font-size: 0.875rem;">
                            <i class="fa-solid fa-calendar-xmark"
                                style="font-size: 1.5rem; margin-bottom: 0.5rem; display:block;"></i>
                            {{ t('noTournamentsFound') || 'No tournaments found matching criteria.' }}
                        </div>

                        <div v-for="(res, idx) in filteredResults" :key="res.id" class="tournament-card-wrapper">
                            <div class="res-card"
                                :style="{'border-left': '4px solid', 'border-left-color': res.statusKey === 'mandatory' ? '#7e22ce' : (res.statusKey === 'main' ? '#10b981' : (res.statusKey === 'qual' || res.statusKey === 'promo' ? '#eab308' : '#ef4444'))}">

                                <div class="flex-between mb-2">
                                    <div>
                                        <h4 style="font-size:0.875rem; font-weight:700;"><span class="res-grade">{{
                                                res.shortGrade }}</span>
                                            <span v-if="res.qualCutoff"
                                                style="font-size:0.5rem; background:#f59e0b; color:white; padding:1px 3px; border-radius:3px; margin-left:2px; vertical-align:middle;">Q-Draw</span>
                                            {{ res.name }}
                                        </h4>
                                        <span style="font-size:0.65rem; color:var(--gray-500);">{{ res.city }} | {{
                                            res.date
                                            }}</span>
                                    </div>
                                    <div style="text-align:right;">
                                        <span style="font-size:0.75rem; font-weight:700; display:block;"
                                            :style="{'color': res.statusKey === 'mandatory' ? '#7e22ce' : (res.statusKey === 'main' ? '#10b981' : (res.statusKey === 'qual' ? '#eab308' : (res.statusKey === 'promo' ? '#eab308' : '#ef4444')))}">{{
                                            res.prediction }}</span>
                                        <div style="font-size:0.5rem; color:var(--gray-400); margin-top:2px;">
                                            <span>Entry:
                                                {{ res.entryDeadline }} <span v-if="res.isEstimated"
                                                    style="color:var(--gray-400); font-size:0.45rem;">(Est.)</span></span><br>
                                            <span>W/D: {{ res.wdDeadline }} <span v-if="res.isEstimated"
                                                    style="color:var(--gray-400); font-size:0.45rem;">(Est.)</span></span><br>
                                            <span
                                                :style="isUrgentMq(res.mqReportDate) ? 'color:#ef4444; font-weight:800; background:#fee2e2; padding:1px 4px; border-radius:4px;' : ''">
                                                M&Q Report: {{ res.mqReportDate }} (Fri)
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="grid-4">
                                    <a :href="getTripLink('flight', res)" target="_blank" class="action-btn">
                                        <i class="fa-solid fa-plane"></i> {{ t('flight') }}
                                    </a>
                                    <a :href="getTripLink('hotel', res)" target="_blank" class="action-btn">
                                        <i class="fa-solid fa-bed"></i> {{ t('hotel') }}
                                    </a>
                                    <a :href="getTripLink('package', res)" target="_blank" class="action-btn">
                                        <i class="fa-solid fa-plane-arrival"></i> {{ t('flightHotel') }}
                                    </a>
                                    <a :href="getTripLink('pickup', res)" target="_blank" class="action-btn">
                                        <i class="fa-solid fa-taxi"></i> {{ t('airportPickup') }}
                                    </a>
                                </div>
                            </div>
                        </div>

                    </div>
                    <p
                        style="font-size:0.55rem; color:var(--gray-400); margin-top:1rem; text-align:center; line-height:1.4;">
                        {{ t('disclaimer') }}</p>
                </div>

                <!-- ‚úÖ NEW: Unified Footer (Buttons + Safety Warning) -->
                <div class="unified-footer">
                    <div class="global-footer-bar">
                        <a class="footer-col" href="https://corporate.bwfbadminton.com/events/calendar/" target="_blank"
                            rel="noopener noreferrer" style="text-decoration:none;">
                            <i class="fa-regular fa-calendar-check" style="margin-right:4px;"></i> {{
                            t('footerCalendar') }}
                        </a>
                        <div class="footer-col footer-brand">Court Mate</div>
                        <div class="footer-col" @click="showConsultModal = true">
                            <i class="fa-solid fa-headset" style="margin-right:4px;"></i> {{ t('footerConsult') }}
                        </div>
                    </div>
                    <div class="safety-warning-footer">
                        <p class="safety-warning-text">
                            <i class="fa-solid fa-triangle-exclamation safety-warning-icon"></i>
                            {{ t('safetyWarning') }}
                        </p>
                    </div>
                </div>

                <!-- ‚úÖ NEW: Plan Circuit Button (shown when 2-3 tournaments selected) -->

                <footer class="p-6 text-center"
                    style="background:var(--gray-50); border-top:1px solid var(--gray-200); margin-top:2rem;">
                    <p style="font-size:0.75rem; color:var(--primary); margin-bottom:0.5rem; font-weight:600;">More
                        useful features are coming soon.</p>
                    <h4 style="font-weight:700; font-size:0.875rem; color:var(--slate-700); margin-bottom:0.5rem;">ROUM
                        S & E Co., Ltd.</h4>
                    <p style="font-size:0.65rem; color:var(--gray-500); line-height:1.6;">#117, 201 Hyangdong-ro,
                        Deogyang-gu, Goyang-si, Gyeonggi-do, Rep. of Korea<br>
                        <span @click="copyEmail"
                            style="cursor:pointer; color:var(--primary); text-decoration:underline;"
                            title="Click to copy email">roumsne@gmail.com</span><br>
                        Copyright ¬© 2026 ROUM S & E. All rights reserved.<br>
                        <span style="font-size:0.5rem; color:var(--gray-400);">v2.1.1 (Data: 2026-02-11)</span>
                    </p>
                </footer>
            </div>
        </div>

        <!-- ‚úÖ NEW: Plan Circuit Button (shown when 2-3 tournaments selected) -->
        <!-- ‚úÖ NEW: Plan Circuit Floating Bar -->

        <div v-if="showConsultModal" class="modal-overlay" @click.self="showConsultModal=false">
            <div class="card animate-fade-in" style="width:100%; max-width:320px; text-align:center; padding: 2rem;">
                <h3 style="margin-bottom:1rem; font-weight:800; font-size: 1.25rem;">{{ t('consultTitle') }}</h3>

                <p
                    style="font-size: 0.9rem; line-height: 1.6; color: var(--slate-700); margin-bottom: 1.5rem; word-break: keep-all;">
                    {{ t('consultDesc') }}
                </p>

                <div @click="copyAgentEmail" class="email-box"
                    style="background: var(--gray-50); border: 1px solid var(--gray-200); padding: 1rem; border-radius: 0.75rem; cursor: pointer; transition: all 0.2s; margin-bottom: 0.5rem;">
                    <i class="fa-regular fa-envelope"
                        style="color: var(--primary); font-size: 1.25rem; margin-bottom: 0.5rem; display: block;"></i>
                    <span style="font-weight: 700; color: var(--slate-800); font-size: 1rem;">withm2k@gmail.com</span>
                    <p style="font-size: 0.65rem; color: var(--gray-500); margin-top: 0.25rem;">(Click to copy)</p>
                </div>

                <div @click="togglePhone" class="phone-box"
                    style="background: var(--gray-50); border: 1px solid var(--gray-200); padding: 1rem; border-radius: 0.75rem; cursor: pointer; transition: all 0.2s;">
                    <i class="fa-solid fa-phone"
                        style="color: var(--primary); font-size: 1.25rem; margin-bottom: 0.5rem; display: block;"></i>
                    <span v-if="!showPhoneNumber" style="font-weight: 700; color: var(--slate-800); font-size: 1rem;">{{
                        t('showNumber') }}</span>
                    <span v-else
                        style="font-weight: 700; color: var(--slate-800); font-size: 1rem;">+82-10-3483-5920</span>
                </div>

                <button class="btn btn-ghost mt-6" @click="showConsultModal=false">{{ t('close') }}</button>
            </div>
        </div>

        <!-- ‚úÖ NEW: Notice Modal -->
        <div v-if="showNoticeModal" class="modal-overlay" @click.self="showNoticeModal=false">
            <div class="card animate-fade-in" style="width:100%; max-width:320px; padding: 1.5rem;">
                <h3 style="margin-bottom:1rem; font-weight:800; font-size: 1.1rem;">{{ t('noticeTitle') }}</h3>

                <ul
                    style="font-size: 0.8rem; line-height: 1.6; color: var(--slate-700); margin-bottom: 1.5rem; padding-left: 1.2rem; list-style-type: decimal;">
                    <li style="margin-bottom: 0.5rem;">
                        {{ t('notice1_1') }}
                        <a href="https://bwfbadminton.com/calendar/" target="_blank"
                            style="color:var(--primary); text-decoration:underline;">BWF Website</a>
                        {{ t('notice1_2') }}
                    </li>
                    <li style="margin-bottom: 0.5rem;">{{ t('notice2') }}</li>
                    <li>{{ t('notice3') }}</li>
                </ul>

                <button class="btn btn-primary w-full" @click="showNoticeModal=false">{{ t('close') }}</button>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, reactive, computed, watch, onMounted } = Vue;

        // ‚úÖ ÏàòÏ†ï: Îã§Íµ≠Ïñ¥ Î©îÏãúÏßÄ Ï∂îÍ∞Ä
        const i18nData = {
            en: {
                searchTitle: 'Search Player', searchPlaceholder: 'Search by Name or BWF ID', searchClear: 'Clear',
                noPlayersFound: 'No players found',
                dataLoadError: 'Failed to load player data. Please check if rankings_data.js exists.',
                simTitle: 'Entry Simulator', simSingles: 'Singles', simDoubles: 'Doubles',
                playerInfo: 'Player Info', rankPoints: 'Rank Points', currentRank: 'Current Rank (e.g. 8)',
                partnerPoints: 'Partner (Optional)',
                partnerPointsPlaceholder: 'Partner (Optional)',
                partnerPointsHint: '',
                optional: '',
                simCalcMethod: 'Calculation Method',
                normal: 'Normal', normalDesc: 'My Points + Partner Points',
                notional: 'Notional Point', notionalDesc: 'Higher 80% + Lower 20%',
                adjusted: 'Adjusted Point',
                simOpt5: '1~5 Tournaments (x 2.0)', simOpt6: '6 Tournaments (x 1.66)', simOpt7: '7 Tournaments (x 1.42)', simOpt8: '8 Tournaments (x 1.25)',
                simBtnRun: 'Analyze Entry', simAnalyzing: 'Analyzing...', simResultTitle: 'Forecast List',
                shareAnalysis: 'Share Analysis', share: 'Share',
                flight: 'Flight', hotel: 'Hotel', disclaimer: '* Disclaimer: Simulation results are for reference only.',
                footerCalendar: 'BWF Calendar', footerConsult: 'Consult',
                consultTitle: 'Feel free to ask',
                consultDesc: 'If you have any inquiries regarding your badminton career, please contact me directly. I am a professional badminton agent who is working with KO Sunghyun, SHIN Baekcheol, and other famous players.',
                showNumber: 'Click to show number',
                close: 'Close',
                mandatory: 'Mandatory', mainSafe: 'Main Draw (Safe)', qualMain: 'Qualifying / Main Draw', promoProbable: 'Promotion Probable', reserve: 'Reserve',
                alertEnterPoints: 'Please enter points.',
                alertInvalidPoints: 'Please enter valid points (0-999,999).',
                alertInvalidRank: 'Please enter valid rank (1-100,000).',
                alertPartnerPoints: 'Please enter partner points for doubles.',
                fillRequiredFields: 'Please fill in all required fields',
                msgEnterPoints: 'Please enter ranking points',
                msgEnterPartnerPoints: 'Please enter partner points for doubles',
                simNotionalTitle: 'Notional Point',
                simNotionalDetail: '80% of Higher Points + 20% of Lower Points',
                simAdjustedTitle: 'Adjusted Point',
                filterRegion: 'Region', filterGrade: 'Tournament Grade', filterAll: 'All',
                regionAsia: 'Asia', regionEurope: 'Europe', regionPanAm: 'Pan Am', regionAfrica: 'Africa', regionOceania: 'Oceania',
                timerEstimate: 'Estimated Time', timerSeconds: 'seconds',
                playerAdvice: 'üö´ Say NO to illegal gambling & drugs. Report it!',
                safetyWarning: 'üö´ Say NO to illegal gambling & drugs. Report it!',
                searchRememberMe: 'Remember Me',
                noTournamentsFound: 'No tournaments found matching your criteria.',
                flightHotel: 'Flight+Hotel', airportPickup: 'Airport Pickup',
                searchHint: 'For players ranked 200+, please enter points manually below.',
                noticeTitle: 'Notice',
                notice1_1: 'Tournament cutoffs are estimated based on internal analysis. For exact past cutoff points, specially S100 or less, please check individually on the ',
                notice1_2: '.',
                notice2: 'Deadlines are estimated dates calculated based on regulations.',
                notice3: 'For tournament inquiries, please check "Consult" below.'
            },
            ko: {
                searchTitle: 'BWF Name(Eng)', searchPlaceholder: 'Ïù¥Î¶Ñ(ÏòÅÎ¨∏) ÎòêÎäî BWF IDÎ°ú Í≤ÄÏÉâ', searchClear: 'ÏßÄÏö∞Í∏∞',
                noPlayersFound: 'ÏÑ†ÏàòÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§',
                dataLoadError: 'ÏÑ†Ïàò Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§ÏßÄ Î™ªÌñàÏäµÎãàÎã§. rankings_data.js ÌååÏùºÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.',
                simTitle: 'ÎåÄÌöå Ï∞∏Í∞Ä ÏãúÎÆ¨Î†àÏù¥ÌÑ∞', simSingles: 'Îã®Ïãù (Singles)', simDoubles: 'Î≥µÏãù (Doubles)',
                playerInfo: 'ÏÑ†Ïàò Ï†ïÎ≥¥ (Player Info)', rankPoints: 'Îû≠ÌÇπ Ìè¨Ïù∏Ìä∏', currentRank: 'ÌòÑÏû¨ Îû≠ÌÇπ (Ïòà: 8)',
                partnerPoints: 'ÌååÌä∏ÎÑà Ìè¨Ïù∏Ìä∏ (ÏÑ†ÌÉù)',
                partnerPointsPlaceholder: 'ÌååÌä∏ÎÑà Ìè¨Ïù∏Ìä∏ (ÏÑ†ÌÉù)',
                partnerPointsHint: 'Î≥µÏãù ÏÑ†ÏàòÎ•º ÏÑ†ÌÉùÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú ÏûÖÎ†•Îê©ÎãàÎã§. ÏßÅÏ†ë ÏûÖÎ†•ÎèÑ Í∞ÄÎä•Ìï©ÎãàÎã§.',
                optional: '',
                simCalcMethod: 'Ìè¨Ïù∏Ìä∏ ÏÇ∞Ï†ï Î∞©Ïãù (GCR 11.7)',
                normal: 'ÏùºÎ∞ò (Normal)', normalDesc: 'ÎÇ¥ Ìè¨Ïù∏Ìä∏ + ÌååÌä∏ÎÑà Ìè¨Ïù∏Ìä∏',
                notional: 'Í∞ÄÏÉÅ Ìè¨Ïù∏Ìä∏ (Notional Point)', notionalDesc: 'ÎÜíÏùÄ Ï†êÏàò 80% + ÎÇÆÏùÄ Ï†êÏàò 20%',
                adjusted: 'Î≥¥Ï†ï Ìè¨Ïù∏Ìä∏ (Adjusted Point)',
                simOpt5: '1~5Í∞ú ÎåÄÌöå Ï∞∏Í∞Ä (x 2.0)', simOpt6: '6Í∞ú ÎåÄÌöå Ï∞∏Í∞Ä (x 1.66)', simOpt7: '7Í∞ú ÎåÄÌöå Ï∞∏Í∞Ä (x 1.42)', simOpt8: '8Í∞ú ÎåÄÌöå Ï∞∏Í∞Ä (x 1.25)',
                simBtnRun: 'Ï∞∏Í∞Ä Í∞ÄÎä• ÎåÄÌöå Î∂ÑÏÑù ÏãúÏûë', simAnalyzing: '3ÎÖÑÏπò Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù Ï§ë...', simResultTitle: '2026 Ï∞∏Í∞Ä ÏòàÏÉÅ Î¶¨Ïä§Ìä∏',
                shareAnalysis: 'Î∂ÑÏÑù Í≤∞Í≥º Í≥µÏú†', share: 'Í≥µÏú†',
                flight: 'Ìï≠Í≥µÍ∂å', hotel: 'Ìò∏ÌÖî', disclaimer: '* Î©¥Ï±Ö Ï°∞Ìï≠: ÏãúÎÆ¨Î†àÏù¥ÏÖò Í≤∞Í≥ºÎäî Ï∞∏Í≥†Ïö©ÏûÖÎãàÎã§.',
                footerCalendar: 'BWF Ï∫òÎ¶∞Îçî', footerConsult: 'ÏÉÅÎã¥ÌïòÍ∏∞',
                consultTitle: 'Î¨¥ÏóáÏù¥Îì† Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî',
                consultDesc: 'Î∞∞ÎìúÎØºÌÑ¥ ÏÑ†Ïàò Í≤ΩÎ†•Ïóê Í¥ÄÌï¥ Í∂ÅÍ∏àÌïú Ï†êÏù¥ ÏûàÏúºÏãúÎ©¥ Ïñ∏Ï†úÎì†ÏßÄ ÏßÅÏ†ë Ïó∞ÎùΩÏ£ºÏÑ∏Ïöî. Ï†ÄÎäî Í≥†ÏÑ±ÌòÑ, Ïã†Î∞±Ï≤† Îì± Ïú†Î™Ö ÏÑ†ÏàòÎì§Í≥º Ìï®Íªò ÏùºÌïòÍ≥† ÏûàÎäî Ï†ÑÎ¨∏ Î∞∞ÎìúÎØºÌÑ¥ ÏóêÏù¥Ï†ÑÌä∏ÏûÖÎãàÎã§.',
                showNumber: 'Ï†ÑÌôîÎ≤àÌò∏ Î≥¥Í∏∞',
                close: 'Îã´Í∏∞',
                mandatory: 'ÏùòÎ¨¥ Ï∞∏Í∞Ä (Top 10)', mainSafe: 'Î≥∏ÏÑ† ÏïàÏ†ïÍ∂å', qualMain: 'ÏòàÏÑ† ÏïàÏ†ïÍ∂å / Î≥∏ÏÑ† Í∞ÄÎä•', promoProbable: 'ÌîÑÎ°úÎ™®ÏÖò Ïú†Î†• (ÎåÄÍ∏∞ 1~5)', reserve: 'ÎåÄÍ∏∞',
                alertEnterPoints: 'Ìè¨Ïù∏Ìä∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.',
                alertInvalidPoints: 'Ïú†Ìö®Ìïú Ìè¨Ïù∏Ìä∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî (0-999,999).',
                alertInvalidRank: 'Ïú†Ìö®Ìïú Îû≠ÌÇπÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî (1-100,000).',
                alertPartnerPoints: 'Î≥µÏãùÏùò Í≤ΩÏö∞ ÌååÌä∏ÎÑà Ìè¨Ïù∏Ìä∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.',
                fillRequiredFields: 'ÌïÑÏàò Ìï≠Î™©ÏùÑ Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî',
                msgEnterPoints: 'Îû≠ÌÇπ Ìè¨Ïù∏Ìä∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî',
                msgEnterPartnerPoints: 'Î≥µÏãùÏùò Í≤ΩÏö∞ ÌååÌä∏ÎÑà Ìè¨Ïù∏Ìä∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî',
                simNotionalTitle: 'Í∞ÄÏÉÅ Ìè¨Ïù∏Ìä∏ (Notional Point)',
                simNotionalDetail: 'ÎÜíÏùÄ Ï†êÏàò 80% + ÎÇÆÏùÄ Ï†êÏàò 20% Ìï©ÏÇ∞',
                simAdjustedTitle: 'Î≥¥Ï†ï Ìè¨Ïù∏Ìä∏ (Adjusted Point)',
                filterRegion: 'ÏßÄÏó≠', filterGrade: 'ÎåÄÌöå Îì±Í∏â', filterAll: 'Ï†ÑÏ≤¥',
                regionAsia: 'ÏïÑÏãúÏïÑ', regionEurope: 'Ïú†ÎüΩ', regionPanAm: 'Ìå¨Ïïî', regionAfrica: 'ÏïÑÌîÑÎ¶¨Ïπ¥', regionOceania: 'Ïò§ÏÑ∏ÏïÑÎãàÏïÑ',
                timerEstimate: 'ÏòàÏÉÅ ÏÜåÏöî ÏãúÍ∞Ñ', timerSeconds: 'Ï¥à',
                playerAdvice: 'üö´ Î∂àÎ≤ï ÎèÑÎ∞ï¬∑ÏïΩÎ¨º Ï†úÏïà Ï¶âÏãú Ïã†Í≥†!',
                safetyWarning: 'üö´ Î∂àÎ≤ï ÎèÑÎ∞ï¬∑ÏïΩÎ¨º Ï†úÏïà Ï¶âÏãú Ïã†Í≥†!',
                searchRememberMe: 'ÏÑ†Ïàò Í∏∞ÏñµÌïòÍ∏∞',
                noTournamentsFound: 'Ï°∞Í±¥Ïóê ÎßûÎäî ÎåÄÌöåÍ∞Ä ÏóÜÏäµÎãàÎã§.',
                flightHotel: 'Ìï≠Í≥µ+Ìò∏ÌÖî', airportPickup: 'Í≥µÌï≠ÌîΩÏóÖ',
                searchHint: '200ÏúÑ Î∞ñÏùò ÏÑ†ÏàòÎäî ÏïÑÎûò Ï†êÏàò Ïπ∏Ïóê ÏßÅÏ†ë ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.',
                noticeTitle: 'Ïú†Ïùò ÏÇ¨Ìï≠',
                notice1_1: 'ÎåÄÌöå Ïª§Ìä∏ÎùºÏù∏ÏùÄ ÏûêÏ≤¥ Î∂ÑÏÑùÌïú ÏûêÎ£åÏùò ÌèâÍ∑†ÏπòÏù¥ÎØÄÎ°ú Ï†ïÌôïÌïú Ï†ÑÎÖÑ Ïª§Ìä∏ÎùºÏù∏ Ìè¨Ïù∏Ìä∏Îäî Í∞úÎ≥ÑÏ†ÅÏúºÎ°ú ',
                notice1_2: 'ÏóêÏÑú Í≤ÄÏÉâÌïòÏÑ∏Ïöî.',
                notice2: 'ÎåÄÌöåÏùò ÎßàÍ∞êÏùºÎì§ÏùÄ Í∑úÏ†ïÏùÑ Ï∞∏Ï°∞Ìï¥ÏÑú Í≥ÑÏÇ∞Ìïú ÏòàÏÉÅÎÇ†Ïßú ÏûÖÎãàÎã§.',
                notice3: 'ÎåÄÌöå Ï∞∏Í∞Ä Í¥ÄÎ†® Î¨∏Ïùò ÏÇ¨Ìï≠ÏùÄ ÏïÑÎûò "ÏÉÅÎã¥ÌïòÍ∏∞"Î•º ÌôïÏù∏Ìï¥ Ï£ºÏÑ∏Ïöî.'
            },
            zh: {
                searchTitle: 'ÊêúÁ¥¢ÁêÉÂëò', searchPlaceholder: 'ÊåâÂßìÂêçÊàñ BWF ID ÊêúÁ¥¢', searchClear: 'Ê∏ÖÈô§',
                noPlayersFound: 'Êú™ÊâæÂà∞ÁêÉÂëò',
                dataLoadError: 'Êó†Ê≥ïÂä†ËΩΩÁêÉÂëòÊï∞ÊçÆ„ÄÇËØ∑Ê£ÄÊü• rankings_data.js Êñá‰ª∂„ÄÇ',
                simTitle: 'ÂèÇËµõÊ®°ÊãüÂô®', simSingles: 'ÂçïÊâì (Singles)', simDoubles: 'ÂèåÊâì (Doubles)',
                playerInfo: 'ÁêÉÂëò‰ø°ÊÅØ (Player Info)', rankPoints: 'ÊéíÂêçÁßØÂàÜ', currentRank: 'ÂΩìÂâçÊéíÂêç (‰æã: 8)',
                partnerPoints: 'Êê≠Ê°£ (ÂèØÈÄâ)',
                partnerPointsPlaceholder: 'Êê≠Ê°£ (ÂèØÈÄâ)',
                partnerPointsHint: 'ÈÄâÊã©ÂèåÊâìÁêÉÂëòÂêé‰ºöËá™Âä®Â°´ÂÖÖ„ÄÇ‰πüÂèØ‰ª•ÊâãÂä®ËæìÂÖ•„ÄÇ',
                optional: '',
                simCalcMethod: 'ÁßØÂàÜËÆ°ÁÆóÊñπÂºè (GCR 11.7)',
                normal: 'ÊôÆÈÄö (Normal)', normalDesc: 'ÊàëÁöÑÁßØÂàÜ + Êê≠Ê°£ÁßØÂàÜ',
                notional: 'ËôöÊãüÁßØÂàÜ (Notional Point)', notionalDesc: 'ËæÉÈ´òÁßØÂàÜ 80% + ËæÉ‰ΩéÁßØÂàÜ 20%',
                adjusted: 'Ë∞ÉÊï¥ÁßØÂàÜ (Adjusted Point)',
                simOpt5: 'ÂèÇÂä† 1~5 ‰∏™ÊØîËµõ (x 2.0)', simOpt6: 'ÂèÇÂä† 6 ‰∏™ÊØîËµõ (x 1.66)', simOpt7: 'ÂèÇÂä† 7 ‰∏™ÊØîËµõ (x 1.42)', simOpt8: 'ÂèÇÂä† 8 ‰∏™ÊØîËµõ (x 1.25)',
                simBtnRun: 'ÂºÄÂßãÂàÜÊûêÂèÇËµõËµÑÊ†º', simAnalyzing: 'Ê≠£Âú®ÂàÜÊûê...', simResultTitle: '2026 ÂèÇËµõÈ¢ÑÊµãÂàóË°®',
                shareAnalysis: 'ÂàÜ‰∫´ÂàÜÊûêÁªìÊûú', share: 'ÂàÜ‰∫´',
                flight: 'Êú∫Á•®', hotel: 'ÈÖíÂ∫ó', disclaimer: '* ÂÖçË¥£Â£∞ÊòéÔºöÊ®°ÊãüÁªìÊûú‰ªÖ‰æõÂèÇËÄÉ„ÄÇ',
                footerCalendar: 'BWF Êó•ÂéÜ', footerConsult: 'Âí®ËØ¢',
                consultTitle: 'ÈöèÊó∂Âí®ËØ¢',
                consultDesc: 'Â¶ÇÊûúÊÇ®ÂØπÁæΩÊØõÁêÉËÅå‰∏öÁîüÊ∂ØÊúâ‰ªª‰ΩïÁñëÈóÆÔºåËØ∑Áõ¥Êé•ËÅîÁ≥ªÊàë„ÄÇÊàëÊòØ‰∏éÈ´òÊàêÁÇ´„ÄÅÁî≥ÁôΩÂñÜÁ≠âËëóÂêçÁêÉÂëòÂêà‰ΩúÁöÑ‰∏ì‰∏öÁæΩÊØõÁêÉÁªèÁ∫™‰∫∫„ÄÇ',
                showNumber: 'ÁÇπÂáªÊòæÁ§∫Âè∑Á†Å',
                close: 'ÂÖ≥Èó≠',
                mandatory: 'Âº∫Âà∂ÂèÇËµõ (Top 10)', mainSafe: 'Ê≠£ËµõÂúà (ÂÆâÂÖ®)', qualMain: 'ËµÑÊ†ºËµõ / Ê≠£ËµõÂèØËÉΩ', promoProbable: 'ÂæàÊúâÂèØËÉΩÊôãÁ∫ß (ÂÄôË°• 1~5)', reserve: 'ÂÄôË°•',
                alertEnterPoints: 'ËØ∑ËæìÂÖ•ÁßØÂàÜ„ÄÇ',
                alertInvalidPoints: 'ËØ∑ËæìÂÖ•ÊúâÊïàÁßØÂàÜ (0-999,999)„ÄÇ',
                alertInvalidRank: 'ËØ∑ËæìÂÖ•ÊúâÊïàÊéíÂêç (1-100,000)„ÄÇ',
                alertPartnerPoints: 'ÂèåÊâìËØ∑ËæìÂÖ•Êê≠Ê°£ÁßØÂàÜ„ÄÇ',
                fillRequiredFields: 'ËØ∑Â°´ÂÜôÊâÄÊúâÂøÖÂ°´È°π',
                msgEnterPoints: 'ËØ∑ËæìÂÖ•ÊéíÂêçÁßØÂàÜ',
                msgEnterPartnerPoints: 'ÂèåÊâìËØ∑ËæìÂÖ•Êê≠Ê°£ÁßØÂàÜ',
                simNotionalTitle: 'ËôöÊãüÁßØÂàÜ (Notional Point)',
                simNotionalDetail: 'ËæÉÈ´òÁßØÂàÜ 80% + ËæÉ‰ΩéÁßØÂàÜ 20%',
                simAdjustedTitle: 'Ë∞ÉÊï¥ÁßØÂàÜ (Adjusted Point)',
                filterRegion: 'Âú∞Âå∫', filterGrade: 'ÊØîËµõÁ≠âÁ∫ß', filterAll: 'ÂÖ®ÈÉ®',
                regionAsia: '‰∫öÊ¥≤', regionEurope: 'Ê¨ßÊ¥≤', regionPanAm: 'Ê≥õÁæé', regionAfrica: 'ÈùûÊ¥≤', regionOceania: 'Â§ßÊ¥ãÊ¥≤',
                timerEstimate: 'È¢ÑËÆ°Êó∂Èó¥', timerSeconds: 'Áßí',
                playerAdvice: 'üö´ ÊãíÁªùËµåÂçöÂíåÊØíÂìÅ¬∑Á´ãÂç≥‰∏æÊä•ÔºÅ',
                safetyWarning: 'üö´ ÊãíÁªùËµåÂçöÂíåÊØíÂìÅ¬∑Á´ãÂç≥‰∏æÊä•ÔºÅ',
                searchRememberMe: 'ËÆ∞‰ΩèÊàë',
                noTournamentsFound: 'Êú™ÊâæÂà∞Á¨¶ÂêàÊù°‰ª∂ÁöÑÊØîËµõ„ÄÇ',
                flightHotel: 'Êú∫ÈÖíÂ•óÈ§ê', airportPickup: 'Êé•ÈÄÅÊú∫',
                searchHint: 'ÊéíÂêç 200+ ÁöÑÁêÉÂëòÔºåËØ∑Âú®‰∏ãÊñπÊâãÂä®ËæìÂÖ•ÁßØÂàÜ„ÄÇ',
                noticeTitle: 'Ê≥®ÊÑè‰∫ãÈ°π',
                notice1_1: 'ÊØîËµõÊà™Ê≠¢ÂàÜÊï∞ÊòØÂü∫‰∫éÂÜÖÈÉ®ÂàÜÊûêÁöÑÂπ≥ÂùáÂÄº„ÄÇÂ¶ÇÈúÄÂáÜÁ°ÆÁöÑËøáÂæÄÊà™Ê≠¢ÂàÜÊï∞ÔºåËØ∑Ëá™Ë°åÂú® ',
                notice1_2: ' Êü•ËØ¢„ÄÇ',
                notice2: 'ÊØîËµõÊà™Ê≠¢Êó•ÊúüÊòØÊ†πÊçÆËßÑÂÆöËÆ°ÁÆóÁöÑÈ¢ÑËÆ°Êó•Êúü„ÄÇ',
                notice3: 'ÂÖ≥‰∫éÊØîËµõÂèÇËµõÁöÑÂí®ËØ¢ÔºåËØ∑Êü•ÈòÖ‰∏ãÊñπÁöÑ‚ÄúÂí®ËØ¢‚Äù„ÄÇ'
            },
            ja: {
                searchTitle: 'ÈÅ∏ÊâãÊ§úÁ¥¢', searchPlaceholder: 'ÂêçÂâç„Åæ„Åü„ÅØBWF ID„ÅßÊ§úÁ¥¢', searchClear: '„ÇØ„É™„Ç¢',
                noPlayersFound: 'ÈÅ∏Êâã„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì',
                dataLoadError: 'ÈÅ∏Êâã„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇrankings_data.js „Éï„Ç°„Ç§„É´„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                simTitle: 'Â§ß‰ºöÂèÇÂä†„Ç∑„Éü„É•„É¨„Éº„Çø„Éº', simSingles: '„Ç∑„É≥„Ç∞„É´„Çπ (Singles)', simDoubles: '„ÉÄ„Éñ„É´„Çπ (Doubles)',
                playerInfo: 'ÈÅ∏ÊâãÊÉÖÂ†± (Player Info)', rankPoints: '„É©„É≥„Ç≠„É≥„Ç∞„Éù„Ç§„É≥„Éà', currentRank: 'ÁèæÂú®„ÅÆÈ†Ü‰Ωç (‰æã: 8)',
                partnerPoints: '„Éë„Éº„Éà„Éä„Éº („Ç™„Éó„Ç∑„Éß„É≥)',
                partnerPointsPlaceholder: '„Éë„Éº„Éà„Éä„Éº („Ç™„Éó„Ç∑„Éß„É≥)',
                partnerPointsHint: '„ÉÄ„Éñ„É´„ÇπÈÅ∏Êâã„ÇíÈÅ∏Êäû„Åô„Çã„Å®Ëá™ÂãïÂÖ•Âäõ„Åï„Çå„Åæ„Åô„ÄÇÊâãÂãïÂÖ•Âäõ„ÇÇÂèØËÉΩ„Åß„Åô„ÄÇ',
                optional: '',
                simCalcMethod: '„Éù„Ç§„É≥„ÉàË®àÁÆóÊñπÊ≥ï (GCR 11.7)',
                normal: 'ÈÄöÂ∏∏ (Normal)', normalDesc: 'Ëá™ÂàÜ„ÅÆ„Éù„Ç§„É≥„Éà + „Éë„Éº„Éà„Éä„Éº„Éù„Ç§„É≥„Éà',
                notional: '„Åø„Å™„Åó„Éù„Ç§„É≥„Éà (Notional Point)', notionalDesc: 'È´ò„ÅÑÊñπ 80% + ‰Ωé„ÅÑÊñπ 20%',
                adjusted: 'Ë™øÊï¥„Éù„Ç§„É≥„Éà (Adjusted Point)',
                simOpt5: '1~5Â§ß‰ºöÂèÇÂä† (x 2.0)', simOpt6: '6Â§ß‰ºöÂèÇÂä† (x 1.66)', simOpt7: '7Â§ß‰ºöÂèÇÂä† (x 1.42)', simOpt8: '8Â§ß‰ºöÂèÇÂä† (x 1.25)',
                simBtnRun: 'ÂèÇÂä†ÂèØËÉΩÊÄß„ÇíÂàÜÊûê', simAnalyzing: 'ÂàÜÊûê‰∏≠...', simResultTitle: '2026 ÂèÇÂä†‰∫àÊÉ≥„É™„Çπ„Éà',
                shareAnalysis: 'ÂàÜÊûêÁµêÊûú„ÇíÂÖ±Êúâ', share: 'ÂÖ±Êúâ',
                flight: 'Ëà™Á©∫Âà∏', hotel: '„Éõ„ÉÜ„É´', disclaimer: '* ÂÖçË≤¨‰∫ãÈ†ÖÔºö„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥ÁµêÊûú„ÅØÂèÇËÄÉÁî®„Åß„Åô„ÄÇ',
                footerCalendar: 'BWF„Ç´„É¨„É≥„ÉÄ„Éº', footerConsult: 'Áõ∏Ë´á„Åô„Çã',
                consultTitle: '„ÅäÊ∞óËªΩ„Å´„ÅäÂïè„ÅÑÂêà„Çè„Åõ„Åè„Å†„Åï„ÅÑ',
                consultDesc: '„Éê„Éâ„Éü„É≥„Éà„É≥„ÅÆ„Ç≠„É£„É™„Ç¢„Å´„Å§„ÅÑ„Å¶„ÅîË≥™Âïè„Åå„ÅÇ„Çå„Å∞„ÄÅÁõ¥Êé•„ÅîÈÄ£Áµ°„Åè„Å†„Åï„ÅÑ„ÄÇÁßÅ„ÅØ„Ç≥„Éª„ÇΩ„É≥„Éí„Éß„É≥ÈÅ∏Êâã„ÇÑ„Ç∑„É≥„Éª„Éô„ÇØ„ÉÅ„Éß„É´ÈÅ∏Êâã„Å™„Å©„ÄÅÊúâÂêç„Å™ÈÅ∏Êâã„Å®‰ªï‰∫ã„Çí„Åó„Å¶„ÅÑ„Çã„Éó„É≠„ÅÆ„Éê„Éâ„Éü„É≥„Éà„É≥„Ç®„Éº„Ç∏„Çß„É≥„Éà„Åß„Åô„ÄÇ',
                showNumber: 'Áï™Âè∑„ÇíË°®Á§∫',
                close: 'Èñâ„Åò„Çã',
                mandatory: 'Áæ©ÂãôÂèÇÂä† (Top 10)', mainSafe: 'Êú¨Êà¶ÂúèÂÜÖ (ÂÆâÂÖ®)', qualMain: '‰∫àÈÅ∏ÂúèÂÜÖ / Êú¨Êà¶ÂèØËÉΩÊÄß', promoProbable: 'ÊòáÊ†ºÊúâÂäõ (Ë£úÊ¨† 1~5)', reserve: 'Ë£úÊ¨†',
                alertEnterPoints: '„Éù„Ç§„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                alertInvalidPoints: 'ÊúâÂäπ„Å™„Éù„Ç§„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ (0-999,999)„ÄÇ',
                alertInvalidRank: 'ÊúâÂäπ„Å™È†Ü‰Ωç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ (1-100,000)„ÄÇ',
                alertPartnerPoints: '„ÉÄ„Éñ„É´„Çπ„ÅÆÂ†¥Âêà„ÅØ„Éë„Éº„Éà„Éä„Éº„Éù„Ç§„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                fillRequiredFields: '„Åô„Åπ„Å¶„ÅÆÂøÖÈ†àÈ†ÖÁõÆ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ',
                msgEnterPoints: '„É©„É≥„Ç≠„É≥„Ç∞„Éù„Ç§„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ',
                msgEnterPartnerPoints: '„ÉÄ„Éñ„É´„Çπ„ÅÆÂ†¥Âêà„ÅØ„Éë„Éº„Éà„Éä„Éº„Éù„Ç§„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ',
                simNotionalTitle: '„Åø„Å™„Åó„Éù„Ç§„É≥„Éà (Notional Point)',
                simNotionalDetail: 'È´ò„ÅÑÊñπ„ÅÆ80% + ‰Ωé„ÅÑÊñπ„ÅÆ20%',
                simAdjustedTitle: 'Ë™øÊï¥„Éù„Ç§„É≥„Éà (Adjusted Point)',
                filterRegion: 'Âú∞Âüü', filterGrade: 'Â§ß‰ºö„Ç∞„É¨„Éº„Éâ', filterAll: '„Åô„Åπ„Å¶',
                regionAsia: '„Ç¢„Ç∏„Ç¢', regionEurope: '„É®„Éº„É≠„ÉÉ„Éë', regionPanAm: '„Éë„É≥„Ç¢„É°„É™„Ç´', regionAfrica: '„Ç¢„Éï„É™„Ç´', regionOceania: '„Ç™„Çª„Ç¢„Éã„Ç¢',
                timerEstimate: '‰∫àÊÉ≥ÊôÇÈñì', timerSeconds: 'Áßí',
                playerAdvice: 'üö´ ÈÅïÊ≥ïË≥≠Âçö„ÉªËñ¨Áâ©„ÅÆË™ò„ÅÑ„ÅØÂç≥ÈÄöÂ†±ÔºÅ',
                safetyWarning: 'üö´ ÈÅïÊ≥ïË≥≠Âçö„ÉªËñ¨Áâ©„ÅÆË™ò„ÅÑ„ÅØÂç≥ÈÄöÂ†±ÔºÅ',
                searchRememberMe: 'ÈÅ∏ÊâãÊÉÖÂ†±„ÇíË®òÊÜ∂',
                noTournamentsFound: 'Êù°‰ª∂„Å´‰∏ÄËá¥„Åô„ÇãÂ§ß‰ºö„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ',
                flightHotel: 'Ëà™Á©∫Âà∏+„Éõ„ÉÜ„É´', airportPickup: 'Á©∫Ê∏ØÈÄÅËøé',
                searchHint: '200‰Ωç‰ª•‰∏ã„ÅÆÈÅ∏Êâã„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆÁÇπÊï∞Ê¨Ñ„Å´Áõ¥Êé•ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                noticeTitle: 'Ê≥®ÊÑè‰∫ãÈ†Ö',
                notice1_1: 'Â§ß‰ºö„ÅÆ„Ç´„ÉÉ„Éà„É©„Ç§„É≥„ÅØÁã¨Ëá™ÂàÜÊûê„Å´„Çà„ÇãÂπ≥ÂùáÂÄ§„Åß„Åô„ÄÇÊ≠£Á¢∫„Å™ÈÅéÂéª„ÅÆ„Ç´„ÉÉ„Éà„É©„Ç§„É≥„Å´„Å§„ÅÑ„Å¶„ÅØ„ÄÅÂÄãÂà•„Å´ ',
                notice1_2: ' „ÅßÊ§úÁ¥¢„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                notice2: 'Â§ß‰ºö„ÅÆÁ∑†ÂàáÊó•„ÅØË¶èÂÆö„Å´Âü∫„Å•„ÅÑ„Å¶Ë®àÁÆó„Åï„Çå„Åü‰∫àÊÉ≥Êó•„Åß„Åô„ÄÇ',
                notice3: 'Â§ß‰ºöÂèÇÂä†„Å´Èñ¢„Åô„Çã„ÅäÂïè„ÅÑÂêà„Çè„Åõ„ÅØ„ÄÅ‰∏ã„ÅÆ„ÄåÁõ∏Ë´á„Åô„Çã„Äç„Çí„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ„ÄÇ'
            }
        };

        // Initialize Vue App after DOM is loaded and deferred scripts are ready
        window.addEventListener('DOMContentLoaded', () => {
            createApp({
                setup() {
                    // Load saved language or default to 'en'
                    const savedLang = localStorage.getItem('courtmate_lang');
                    const currentLang = ref(savedLang || 'en');
                    const rememberPlayer = ref(false); // ‚úÖ NEW: Remember Me State
                    const selectedPlayer = ref(null); // ‚úÖ NEW: Track selected player object
                    const showPhoneNumber = ref(false); // ‚úÖ NEW: Phone number toggle

                    const showConsultModal = ref(false);
                    const showNoticeModal = ref(false); // ‚úÖ NEW: Notice Modal State
                    const searchQuery = ref('');
                    const showSearchResults = ref(false);
                    const dataLoadError = ref(false);
                    const darkMode = ref(false);

                    // ‚úÖ NEW: Phone Toggle Function
                    const togglePhone = () => {
                        showPhoneNumber.value = !showPhoneNumber.value;
                    };
                    const validationErrors = reactive({
                        points: '',
                        rank: '',
                        partnerPoints: ''
                    });

                    // ‚úÖ NEW: Tournament Filters
                    const filters = reactive({
                        selectedRegions: [],
                        selectedGrades: []
                    });

                    // ‚úÖ NEW: Timer State
                    const timerState = reactive({
                        countdown: 0,
                        intervalId: null
                    });

                    // ‚úÖ NEW: Loading Logs State
                    const loadingLogs = ref([
                        { message: 'DB Searching...', done: false },
                        { message: 'Parsing Week 7 Rankings...', done: false },
                        { message: 'Loading 2026 Calendar...', done: false },
                        { message: 'Analyzing Tournament Data...', done: false },
                        { message: 'Preparing Smart Recommendations...', done: false }
                    ]);
                    const loadingProgress = ref(0);



                    // ‚úÖ NEW: City to Airport Code Mapping (Expanded for BWF 2026)
                    const cityMap = {
                        // Major Asian Hubs
                        'ÏÑúÏö∏': 'ICN', 'Ïù∏Ï≤ú': 'ICN', 'seoul': 'ICN', 'incheon': 'ICN', 'gimpo': 'GMP', 'kimpo': 'GMP',
                        'Î∂ÄÏÇ∞': 'PUS', 'busan': 'PUS', 'gimhae': 'PUS',
                        'ÎåÄÍµ¨': 'TAE', 'daegu': 'TAE', 'Ï≤≠Ï£º': 'CJJ', 'cheongju': 'CJJ', 'Ï†úÏ£º': 'CJU', 'jeju': 'CJU',
                        'ÎèÑÏøÑ': 'NRT', 'tokyo': 'NRT', 'ÎÇòÎ¶¨ÌÉÄ': 'NRT', 'narita': 'NRT', 'haneda': 'HND',
                        'Ïò§ÏÇ¨Ïπ¥': 'KIX', 'osaka': 'KIX', 'kansai': 'KIX',
                        'ÌõÑÏø†Ïò§Ïπ¥': 'FUK', 'fukuoka': 'FUK',
                        'ÎÇòÍ≥†Ïïº': 'NGO', 'nagoya': 'NGO', 'kumamoto': 'KMJ', 'aichi': 'NGO',
                        'Î≤†Ïù¥Ïßï': 'PEK', 'beijing': 'PEK', 'ÏÉÅÌïòÏù¥': 'PVG', 'shanghai': 'PVG',
                        'Ìï≠Ï†ÄÏö∞': 'HGH', 'hangzhou': 'HGH', 'shenzhen': 'SZX', 'lingshui': 'SYX', // Lingshui -> Sanya (closest)
                        'Ï≤≠Îëê': 'CTU', 'chengdu': 'CTU',
                        'Î∞©ÏΩï': 'BKK', 'bangkok': 'BKK', 'chiang mai': 'CNX',
                        'Ïø†ÏïåÎùºÎ£∏Ìë∏Î•¥': 'KUL', 'kuala lumpur': 'KUL', 'kuching': 'KCH',
                        'ÏûêÏπ¥Î•¥ÌÉÄ': 'CGK', 'jakarta': 'CGK', 'surabaya': 'SUB',
                        'Ïã±Í∞ÄÌè¨Î•¥': 'SIN', 'singapore': 'SIN',
                        'ÌÉÄÏù¥Î≤†Ïù¥': 'TPE', 'taipei': 'TPE', 'kaohsiung': 'KHH',
                        'ÌôçÏΩ©': 'HKG', 'hong kong': 'HKG',
                        'ÌïòÎÖ∏Ïù¥': 'HAN', 'hanoi': 'HAN', 'Ìò∏ÏπòÎØº': 'SGN', 'ho chi minh': 'SGN',
                        'ÎßàÎãêÎùº': 'MNL', 'manila': 'MNL',
                        'Îâ¥Îç∏Î¶¨': 'DEL', 'new delhi': 'DEL', 'hyderabad': 'HYD', 'guwahati': 'GAU',

                        // Europe
                        'ÌååÎ¶¨': 'CDG', 'paris': 'CDG', 'lyon': 'LYS', 'orleans': 'ORY',
                        'Îü∞Îçò': 'LHR', 'london': 'LHR', 'birmingham': 'BHX',
                        'ÌîÑÎûëÌÅ¨Ìë∏Î•¥Ìä∏': 'FRA', 'frankfurt': 'FRA', 'mulheim': 'DUS', 'saarbrucken': 'SCN',
                        'ÏΩîÌéúÌïòÍ≤ê': 'CPH', 'copenhagen': 'CPH', 'odense': 'BLL', // Odense -> Billund (closest major)
                        'Î∞îÏ†§': 'BSL', 'basel': 'BSL',
                        'ÎßàÎìúÎ¶¨Îìú': 'MAD', 'madrid': 'MAD', 'barcelona': 'BCN',

                        // Americas & Oceania
                        'Î°úÏä§Ïï§Ï†§Î†àÏä§': 'LAX', 'los angeles': 'LAX', 'new orleans': 'MSY',
                        'Ï∫òÍ±∞Î¶¨': 'YYC', 'calgary': 'YYC',
                        'ÏãúÎìúÎãà': 'SYD', 'sydney': 'SYD', 'melbourne': 'MEL'
                    };

                    // ‚úÖ NEW: Helper to get Airport Code
                    const getAirportCode = (input) => {
                        if (!input) return 'ICN';

                        // Handle "City, Country" format (e.g. "Kuala Lumpur, MAS")
                        let key = input.split(',')[0].trim().toLowerCase();

                        // Check direct map
                        if (cityMap[key]) return cityMap[key];

                        // Try removing spaces (e.g. "new delhi" -> "newdelhi") if needed, 
                        // but our map currently has keys with spaces.

                        // Fallback to strict input if not found? 
                        // Trip.com might fail with "Kuala Lumpur, MAS". 
                        // Better to return the city name part at least if no code found.
                        return key.charAt(0).toUpperCase() + key.slice(1);
                    };






                    const playerNationality = ref('');  // Based on player country

                    // ‚úÖ ÏàòÏ†ï: rankings_data.js Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÌôïÏù∏
                    const rankingsDataRaw = window.RANKINGS_2026_RAW || {};

                    // ‚úÖ Ï∂îÍ∞Ä: Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÌôïÏù∏
                    if (!window.RANKINGS_2026_RAW || Object.keys(window.RANKINGS_2026_RAW).length === 0) {
                        dataLoadError.value = true;
                        console.error('‚ö†Ô∏è RANKINGS_2026_RAW data not found. Please ensure rankings_data.js is loaded.');
                    }

                    // ‚úÖ ÏàòÏ†ï: ÏÑ†Ïàò Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨ Í∞úÏÑ†
                    const allPlayers = computed(() => {
                        let players = [];
                        for (const [cat, list] of Object.entries(rankingsDataRaw)) {
                            if (Array.isArray(list)) {
                                list.forEach(p => {
                                    players.push({
                                        ...p,
                                        category: cat,
                                        // player ÌïÑÎìúÎ•º nameÏúºÎ°úÎèÑ ÏÇ¨Ïö© Í∞ÄÎä•ÌïòÎèÑÎ°ù
                                        name: p.name || p.player,
                                        id: p.id || p.member_id,
                                        // pointsÎ•º Ïà´ÏûêÎ°ú Î≥ÄÌôò (ÏâºÌëú Ï†úÍ±∞)
                                        numericPoints: typeof p.points === 'string' ?
                                            (parseInt(p.points.replace(/,/g, '')) || 0) :
                                            (p.points || 0)
                                    });
                                });
                            }
                        }
                        return players;
                    });

                    // ‚úÖ ÏàòÏ†ï: Í≤ÄÏÉâ ÏïåÍ≥†Î¶¨Ï¶ò Í∞úÏÑ†
                    const searchResults = computed(() => {
                        if (!searchQuery.value) return [];
                        const q = searchQuery.value.toLowerCase().trim();

                        return allPlayers.value.filter(p => {
                            const nameMatch = p.name && p.name.toLowerCase().includes(q);
                            const countryMatch = p.country && p.country.toLowerCase().includes(q);
                            const categoryMatch = p.category && p.category.toLowerCase().includes(q);
                            const idMatch = p.id && p.id.toString().includes(q);
                            const rankMatch = p.rank && p.rank.toString() === q;

                            return nameMatch || countryMatch || categoryMatch || idMatch || rankMatch;
                        })
                            .sort((a, b) => {
                                // Îû≠ÌÇπ ÏàúÏúºÎ°ú Ï†ïÎ†¨
                                return parseInt(a.rank) - parseInt(b.rank);
                            })
                            .slice(0, 20);
                    });

                    // ‚úÖ Ï∂îÍ∞Ä: Ìè¨Ïù∏Ìä∏ Ìè¨Îß∑ÌåÖ Ìï®Ïàò
                    const formatPoints = (points) => {
                        if (typeof points === 'string') {
                            points = parseInt(points.replace(/,/g, ''));
                        }
                        return points.toLocaleString();
                    };

                    // ‚úÖ ÏàòÏ†ï: ÏÑ†Ïàò ÏÑ†ÌÉù Ìï®Ïàò Í∞úÏÑ†
                    const selectPlayer = (p) => {
                        // points Í∞í Ï†ïÍ∑úÌôî (Î¨∏ÏûêÏó¥ ÎòêÎäî Ïà´Ïûê Î™®Îëê Ï≤òÎ¶¨)
                        const totalPoints = typeof p.points === 'string' ?
                            parseInt(p.points.replace(/,/g, '')) :
                            parseInt(p.points);

                        sim.currentRank = parseInt(p.rank);
                        sim.guestEvent = p.category;
                        sim.type = (p.category === 'MD' || p.category === 'WD' || p.category === 'XD') ? 'doubles' : 'singles';

                        // ‚úÖ Ï∂îÍ∞Ä: Î≥µÏãùÏùº Í≤ΩÏö∞ Í∞Å ÏÑ†ÏàòÏùò Í∞úÎ≥Ñ Ìè¨Ïù∏Ìä∏Î•º Ï∞æÏïÑÏÑú ÏÑ§Ï†ï
                        if (sim.type === 'doubles') {
                            // For existing pairs in the database, the points listed are already the pair's points (not individual).
                            // New Logic: Use the pair's points as "Player 1 Points" and leave "Partner Points" empty.
                            // This triggers "Case A" in the calculation logic (v2 = 0 -> return v1).

                            sim.guestPoints = totalPoints;
                            sim.partnerPoints = null;

                            // (Legacy logic removed: trying to split points or find individual points)
                        } else {
                            sim.guestPoints = totalPoints;
                            sim.partnerPoints = null;
                        }

                        if (rememberPlayer.value) {
                            // Save player info to localStorage
                            const playerToSave = {
                                ...p,
                                points: typeof p.points === 'string' ? p.points : p.points.toString()
                            };
                            localStorage.setItem('courtmate_saved_player', JSON.stringify(playerToSave));
                            localStorage.setItem('courtmate_remember_me', 'true');
                        }

                        selectedPlayer.value = p; // Keep track of selected player

                        clearSearch();
                        validateInputs();
                    };

                    // ‚úÖ NEW: Watch rememberPlayer to save/clear current player
                    watch(rememberPlayer, (newVal) => {
                        localStorage.setItem('courtmate_remember_me', newVal ? 'true' : 'false');

                        if (newVal && selectedPlayer.value) {
                            const playerToSave = {
                                ...selectedPlayer.value,
                                points: typeof selectedPlayer.value.points === 'string' ? selectedPlayer.value.points : selectedPlayer.value.points.toString()
                            };
                            localStorage.setItem('courtmate_saved_player', JSON.stringify(playerToSave));
                        } else if (!newVal) {
                            localStorage.removeItem('courtmate_saved_player');
                        }
                    });

                    // ‚úÖ Ï∂îÍ∞Ä: Í≤ÄÏÉâ Ï¥àÍ∏∞Ìôî Ìï®Ïàò
                    const clearSearch = () => {
                        searchQuery.value = '';
                        showSearchResults.value = false;
                    };

                    const sim = reactive({
                        type: 'singles',
                        calcMethod: 'normal',
                        playedCount: '5',
                        partnerPoints: null,
                        guestEvent: 'MS',
                        guestPoints: null,
                        currentRank: null,
                        finalPoints: 0,
                        results: null,
                        loading: false
                    });

                    // ‚úÖ Ï∂îÍ∞Ä: ÏûÖÎ†• Ïú†Ìö®ÏÑ± Í≤ÄÏ¶ù
                    const validateInputs = () => {
                        validationErrors.points = '';
                        validationErrors.rank = '';
                        validationErrors.partnerPoints = '';

                        if (sim.guestPoints !== null && (sim.guestPoints < 0 || sim.guestPoints > 999999)) {
                            validationErrors.points = t('alertInvalidPoints');
                        }

                        if (sim.currentRank !== null && (sim.currentRank < 1 || sim.currentRank > 100000)) {
                            validationErrors.rank = t('alertInvalidRank');
                        }

                        if (sim.type === 'doubles' && sim.partnerPoints !== null && (sim.partnerPoints < 0 || sim.partnerPoints > 999999)) {
                            validationErrors.partnerPoints = t('alertInvalidPoints');
                        }
                    };

                    // ‚úÖ Ï∂îÍ∞Ä: Ìèº Ïú†Ìö®ÏÑ± Ï≤¥ÌÅ¨
                    const isFormValid = computed(() => {
                        // Í∏∞Î≥∏ Ìè¨Ïù∏Ìä∏ Ï≤¥ÌÅ¨
                        if (!sim.guestPoints || sim.guestPoints < 0 || sim.guestPoints > 999999) {
                            return false;
                        }

                        // Îû≠ÌÇπ Ï≤¥ÌÅ¨ (ÏÑ†ÌÉùÏÇ¨Ìï≠Ïù¥ÎØÄÎ°ú ÏûÖÎ†•ÌñàÏùÑ ÎïåÎßå Í≤ÄÏ¶ù)
                        if (sim.currentRank && (sim.currentRank < 1 || sim.currentRank > 100000)) {
                            return false;
                        }

                        // ‚úÖ ÏàòÏ†ï: Î≥µÏãùÏùº Îïå ÌååÌä∏ÎÑà Ìè¨Ïù∏Ìä∏Îäî ÏÑ†ÌÉùÏÇ¨Ìï≠ (ÏóÜÏúºÎ©¥ ÎÇ¥ Ìè¨Ïù∏Ìä∏Îßå ÏÇ¨Ïö©)
                        // ÏûÖÎ†•ÌñàÏùÑ Í≤ΩÏö∞ÏóêÎßå Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
                        if (sim.type === 'doubles' && sim.partnerPoints) {
                            if (sim.partnerPoints < 0 || sim.partnerPoints > 999999) {
                                return false;
                            }
                        }

                        return true;
                    });





                    // ‚úÖ Ï∂îÍ∞Ä: t Ìï®ÏàòÎ•º Î®ºÏ†Ä Ï†ïÏùò (runSimulationÏóêÏÑú ÏÇ¨Ïö©ÌïòÍ∏∞ ÎïåÎ¨∏)
                    const t = (key) => (i18nData[currentLang.value] || i18nData.en)[key] || key;

                    // ‚úÖ Ï∂îÍ∞Ä: Í≤ÄÏ¶ù Î©îÏãúÏßÄ Ìï®Ïàò
                    const getValidationMessage = () => {
                        if (!sim.guestPoints) {
                            return t('msgEnterPoints');
                        }
                        // ‚úÖ ÏàòÏ†ï: ÌååÌä∏ÎÑà Ìè¨Ïù∏Ìä∏Îäî ÏÑ†ÌÉùÏÇ¨Ìï≠ÏúºÎ°ú Î≥ÄÍ≤Ω
                        // if (sim.type === 'doubles' && !sim.partnerPoints) {
                        //     return t('msgEnterPartnerPoints');
                        // }
                        return t('fillRequiredFields');
                    };

                    // ‚úÖ ÏàòÏ†ï: Î≥µÏãù Ìè¨Ïù∏Ìä∏ Í≥ÑÏÇ∞ Î°úÏßÅ Í∞úÏÑ† (BWF Í∑úÏ†ïÏóê ÎßûÍ≤å)
                    const runSimulation = () => {
                        if (!sim.guestPoints) {
                            alert(t('alertEnterPoints'));
                            return;
                        }

                        if (!isFormValid.value) {
                            alert(t('alertInvalidPoints'));
                            return;
                        }

                        sim.loading = true;
                        sim.results = null;


                        // ‚úÖ NEW: Reset and Start Log-Based Loading Animation
                        loadingLogs.value.forEach(log => log.done = false);
                        loadingProgress.value = 0;

                        // Clear old timer if exists
                        if (timerState.intervalId) clearInterval(timerState.intervalId);

                        // Simulate progressive loading with logs
                        const logTimings = [0, 150, 300, 450, 600]; // Milliseconds for each step
                        logTimings.forEach((delay, index) => {
                            setTimeout(() => {
                                loadingLogs.value[index].done = true;
                                loadingProgress.value = ((index + 1) / loadingLogs.value.length) * 100;
                            }, delay);
                        });

                        // ‚úÖ NEW: BWF Standard Point Calculator
                        const calculateTeamPoints = (p1, p2) => {
                            // 1. Convert inputs to integers (remove commas)
                            const v1 = parseInt(String(p1).replace(/,/g, '')) || 0;
                            const v2 = parseInt(String(p2).replace(/,/g, '')) || 0;

                            // 2. Singles Case (or only one input provided -> Existing Pair Total)
                            if (v2 === 0) return v1;

                            // 3. Doubles Logic Branch

                            // Case A: Existing Partner (Points are similar within 1% margin)
                            // Assume user entered individual points for an existing pair where A ‚âà B
                            if (Math.abs(v1 - v2) < (v1 * 0.01)) {
                                return Math.max(v1, v2); // Return the max (do not add, do not divide)
                            }

                            // Case B: New Combination (Notional Ranking)
                            // "Higher Rank x 80% + Lower Rank x 20%"
                            const high = Math.max(v1, v2);
                            const low = Math.min(v1, v2);

                            const notionalPoint = (high * 0.8) + (low * 0.2);

                            return Math.round(notionalPoint);
                        };

                        let entryPoints = 0;

                        // Apply new logic
                        let p1 = sim.guestPoints || 0;
                        let p2 = sim.partnerPoints || 0;

                        // Calculate Base Entry Points using BWF Rules
                        let baseEntryPoints = calculateTeamPoints(p1, p2);

                        if (sim.calcMethod === 'normal') {
                            entryPoints = baseEntryPoints;
                        }
                        else if (sim.calcMethod === 'notional') {
                            // Explicit Notional Option (Force Notional Formula if user selects this check)
                            // Use logic from Case B regardless of similarity?
                            // User said: "Case B: New/Notional Pair... Logic: Apply BWF Notional Ranking Formula."
                            // Let's reuse the helper but force the v2!=0 path effectively?
                            // Or just use the formula directly for clarity since user selected "Notional".
                            const v1 = parseInt(String(p1).replace(/,/g, '')) || 0;
                            const v2 = parseInt(String(p2).replace(/,/g, '')) || 0;
                            const high = Math.max(v1, v2);
                            const low = Math.min(v1, v2);
                            // If v2 is 0 (one player), Notional doesn't make sense, just return v1.
                            if (v2 === 0) entryPoints = v1;
                            else entryPoints = Math.round((high * 0.8) + (low * 0.2));
                        }
                        else {
                            // Adjusted Points (For limited tournament participation)
                            // Factor * Base Entry Points
                            const factors = { '5': 2.0, '6': 1.66, '7': 1.42, '8': 1.25 };
                            entryPoints = baseEntryPoints * (factors[sim.playedCount] || 1);
                        }

                        sim.finalPoints = Math.floor(entryPoints);

                        setTimeout(() => {
                            // Clear timer
                            if (timerState.intervalId) {
                                clearInterval(timerState.intervalId);
                                timerState.intervalId = null;
                            }

                            // Validate data availability
                            const real2026Tournaments = window.tournaments2026 || [];

                            // Debug removed: if (real2026Tournaments.length === 0) { alert(...) }

                            let tournamentsToUse = [];

                            if (real2026Tournaments.length > 0) {
                                console.log('‚úÖ Loaded 2026 Tournaments:', real2026Tournaments.length);
                                // Use real 2026 tournament data - format it for the app
                                tournamentsToUse = real2026Tournaments.map(t => ({
                                    name: t.name,
                                    city: t.city,
                                    country: t.country,
                                    region: t.region,
                                    grade: t.grade,
                                    dates: `${t.startDate} ~ ${t.endDate}`,
                                    entryDeadline: t.startDate, // Use start date as deadline for now
                                    status: 'OPEN',
                                    cutoff: 0 // Will be predicted
                                }));
                            } else {
                                console.warn('No 2026 tournament data found');
                            }

                            const today = new Date().toISOString().split('T')[0];
                            // Debug removed: console.log('Filtering against today:', today);

                            // Filter: Only OPEN tournaments with future entry deadlines
                            const availableTournaments = tournamentsToUse.filter(t => {
                                // Handle special deadlines (Selection, Qualification, etc.)
                                if (typeof t.entryDeadline === 'string' &&
                                    (t.entryDeadline.includes('Selection') ||
                                        t.entryDeadline.includes('Qualification') ||
                                        t.entryDeadline.includes('Ranking'))) {
                                    return t.status === 'OPEN';
                                }
                                return t.entryDeadline >= today && t.status === 'OPEN';
                            });

                            // Debug removed: console.log(...) & alert(...)

                            // Map to expected format
                            const formattedTournaments = availableTournaments.map(t => {
                                // Parse dates from "2026-01-06 ~ 2026-01-11" format
                                const dateParts = t.dates.split('~');
                                const startIso = dateParts[0].trim();
                                const endIso = dateParts[1] ? dateParts[1].trim() : startIso;

                                // Format date for display: "Jan 06-11"
                                const startDate = new Date(startIso);
                                const endDate = new Date(endIso);
                                const monthStr = startDate.toLocaleString('en-US', { month: 'short' });
                                const startDay = startDate.getDate();
                                const endDay = endDate.getDate();
                                const dateDisplay = `${monthStr} ${startDay < 10 ? '0' : ''}${startDay}-${endDay < 10 ? '0' : ''}${endDay}`;

                                // ‚úÖ BWF Deadline Calculation (GCR Rules)
                                let entryDeadline = "TBA";
                                let wdDeadline = "TBA";
                                let mqReportDate = "TBA";
                                let isEstimated = false;

                                const gradeLower = (t.grade || '').toLowerCase();
                                const isGrade1 = gradeLower.includes('grade 1') ||
                                    gradeLower.includes('championship') ||
                                    gradeLower.includes('games') ||
                                    gradeLower.includes('thomas') ||
                                    gradeLower.includes('uber') ||
                                    gradeLower.includes('sudirman');

                                // Skip calculation for Grade 1 events (Manual/TBA)
                                if (!isGrade1) {
                                    let offset = 35; // Default (S300, S100, IC, IS, FS, Junior)

                                    // Higher grades have earlier deadline (42 days / 6 weeks)
                                    if (gradeLower.includes('1000') || gradeLower.includes('750') || gradeLower.includes('500')) {
                                        offset = 42;
                                    }

                                    // Calculate Entry Deadline
                                    const entryDate = new Date(startIso);
                                    entryDate.setDate(entryDate.getDate() - offset);

                                    // Ensure Entry Deadline is a Tuesday? 
                                    // User said: "Note: Ensure the calculated Entry Deadline falls on a Tuesday."
                                    // Let's try to adjust to nearest Tuesday if needed, but for now simple offset from T0 (usually Tuesday) works.
                                    // If T0 is Tuesday, T0-35 and T0-42 are also Tuesdays.

                                    entryDeadline = entryDate.toISOString().split('T')[0];

                                    // Calculate Withdrawal Deadline (Monday, T0 - 8 days??)
                                    // User prompt: "T0 - 8 Days (Monday)"
                                    // Standard BWF rule is usually M&Q + roughly 10-12 days?
                                    // Let's follow USER instruction: T0 - 8 days.
                                    const wdDate = new Date(startIso);
                                    wdDate.setDate(wdDate.getDate() - 8); // Monday before tournament week? 
                                    // Actually usually tournament starts Tuesday. Monday before is T-1. 
                                    // T-8 is the Monday of the week PRIOR.
                                    wdDeadline = wdDate.toISOString().split('T')[0];

                                    // [NEW] Calculate M&Q Report Date (Entry Date + 3 Days => Friday)
                                    const mqDate = new Date(entryDate);
                                    mqDate.setDate(entryDate.getDate() + 3);
                                    mqReportDate = mqDate.toISOString().split('T')[0];

                                    isEstimated = true;
                                } else {
                                    // For Grade 1, keep as TBA
                                }

                                // Get cutoff points (handle both old and new formats)
                                const cutOff = t.cutOffPoints?.main || t.cutoff || 0;

                                // Short grade format (Abbreviated)
                                let shortGrade = t.grade || '';

                                // 1. Remove standard prefixes
                                shortGrade = shortGrade
                                    .replace(/HSBC BWF World Tour Super/g, 'S')
                                    .replace(/BWF Tour Super/g, 'S')
                                    .replace(/Super/g, 'S')
                                    .replace(/Grade/g, 'G');

                                // 2. Map Juniors specific titles (First pass)
                                shortGrade = shortGrade
                                    .replace(/Junior International Challenge/g, 'JIC')
                                    .replace(/Junior International Series/g, 'JIS')
                                    .replace(/Junior Future Series/g, 'JFS')
                                    .replace(/Junior International Grand Prix/g, 'JIGP');

                                // 3. Map Seniors specific titles
                                shortGrade = shortGrade
                                    .replace(/International Challenge/g, 'IC')
                                    .replace(/International Series/g, 'IS')
                                    .replace(/Future Series/g, 'FS');

                                // 4. Map Championships
                                shortGrade = shortGrade
                                    .replace(/Continental Junior Individual Championships/g, 'CJIC')
                                    .replace(/Continental Individual Championships/g, 'CIC');

                                // 5. Clean up leftovers
                                shortGrade = shortGrade
                                    .replace(/Junior/g, 'Jnr')
                                    .replace(/Grand Prix/g, 'GP')
                                    .replace(/S\s+/g, 'S') // Remove space after S (S 1000 -> S1000)
                                    .trim();

                                // 6. Handle empty grades with Name-based U-event detection
                                if (!shortGrade && (t.name.includes('U19') || t.name.includes('U17') || t.name.includes('U15') || t.name.includes('U13'))) {
                                    const match = t.name.match(/U\d{2}/);
                                    if (match) shortGrade = match[0];
                                }

                                return {
                                    name: t.name,
                                    shortGrade: shortGrade.trim(),
                                    grade: t.grade, // ‚úÖ Pass original grade for filtering
                                    city: t.city,
                                    country: t.country,
                                    date: dateDisplay,
                                    cutOff: typeof cutOff === 'number' ? cutOff : 0,
                                    entryDeadline: entryDeadline,
                                    wdDeadline: wdDeadline,
                                    mqReportDate: mqReportDate,
                                    isEstimated: isEstimated,
                                    startIso: startIso,
                                    endIso: endIso
                                };
                            });

                            // Helper to get estimated points if cutoff is missing
                            // Based on 2025 Season Average Entrants
                            // Helper to get estimated points if cutoff is missing
                            // Based on 2025 Season Average Entrants
                            const getPointsByGrade = (grade, subRegion) => {
                                if (!grade) return { main: 0, qual: null };

                                // Base Points (Standard difficulty - primarily Asia-East/SE)
                                let basePoints = 1000;
                                // Qualifying Ratio (default null)
                                let qualRatio = null;
                                let qualBase = null;

                                if (grade.includes('S1000')) { basePoints = 47000; qualRatio = null; }
                                else if (grade.includes('S750')) { basePoints = 39000; qualRatio = null; }
                                else if (grade.includes('S500')) { basePoints = 29000; qualRatio = 0.4; } // Qual ~11,600
                                else if (grade.includes('S300')) { basePoints = 21000; qualRatio = 0.3; } // Qual ~6,300
                                else if (grade.includes('S100')) { basePoints = 9000; qualBase = 2500; }  // Qual Fixed ~2,500
                                else if (grade.includes('GP')) { basePoints = 6000; qualBase = 1500; }
                                else if (grade.includes('IC')) { basePoints = 6000; qualBase = 1500; }
                                else if (grade.includes('JIC')) { basePoints = 2500; qualBase = 1000; }
                                else if (grade.includes('IS')) { basePoints = 3000; qualBase = 1000; }
                                else if (grade.includes('JIS')) { basePoints = 1500; qualBase = 800; }
                                else if (grade.includes('FS')) { basePoints = 1500; qualBase = 800; }
                                else if (grade.includes('JFS')) { basePoints = 800; qualBase = 400; }
                                else if (grade.includes('U19') || grade.includes('Jnr')) { basePoints = 800; qualBase = 400; }

                                // ‚úÖ Regional Multipliers (Difficulty Factor)
                                const multipliers = {
                                    'Asia-East': 1.2,   // very hard
                                    'Asia-SE': 1.1,     // hard
                                    'Asia-South': 1.0,  // standard
                                    'Asia-West': 0.8,   // easier
                                    'Asia-Central': 0.7,// easiest in Asia
                                    'Europe': 1.0,      // standard
                                    'PanAm-North': 0.75,// easier
                                    'PanAm-South': 0.7, // easier
                                    'Oceania': 0.7,     // easier
                                    'Africa': 0.6       // easiest
                                };

                                const baseMultiplier = multipliers[subRegion] || 1.0;

                                // ‚úÖ Grade Sensitivity Factor: Apply regional weight based on tournament tier
                                let gradeFactor = 1.0; // Default: Full regional impact (S300, S100, IC/IS/FS)

                                if (grade.includes('S1000') || grade.includes('S750')) {
                                    gradeFactor = 0.1; // 10% impact (Global field)
                                } else if (grade.includes('S500')) {
                                    gradeFactor = 0.5; // 50% impact
                                }

                                // Calculate Effective Modifier
                                // Formula: 1.0 + (Base - 1.0) * Factor
                                // Example: PanAm (0.75) for S1000 (0.1) -> 1.0 + (-0.25 * 0.1) = 0.975
                                const effectiveModifier = 1.0 + ((baseMultiplier - 1.0) * gradeFactor);

                                const mainCutoff = Math.floor(basePoints * effectiveModifier);
                                let qualCutoff = null;

                                if (qualBase !== null) {
                                    qualCutoff = Math.floor(qualBase * effectiveModifier);
                                } else if (qualRatio !== null) {
                                    qualCutoff = Math.floor(mainCutoff * qualRatio);
                                }

                                return { main: mainCutoff, qual: qualCutoff };
                            };

                            sim.results = formattedTournaments.map(tournament => {
                                // Determine Sub-Region
                                const regionInfo = getTournamentRegion(tournament.country);
                                const subRegion = regionInfo.subRegion;

                                // If data has no cutoff, use estimate based on grade & region
                                let cutoffData = { main: tournament.cutOff || 0, qual: tournament.qualCutoff || null };

                                // If DB entry missing main cutoff, calculate it
                                if (!cutoffData.main || cutoffData.main === 0) {
                                    cutoffData = getPointsByGrade(tournament.shortGrade, subRegion);
                                } else if (!cutoffData.qual) {
                                    // If DB has main but not qual, try to estimate qual from main?
                                    // Only for relevant grades
                                    const estimated = getPointsByGrade(tournament.shortGrade, subRegion);
                                    if (estimated.qual) {
                                        // Recalculate qual based on ratio if applicable, or just use estimated qual
                                        // Let's just use the logic from getPointsByGrade but applied to the DB main cutoff if reasonable?
                                        // Or simply take the estimated qual.
                                        cutoffData.qual = estimated.qual;
                                    }
                                }

                                let prediction = '', diff = 0, statusKey = '';
                                const userPts = sim.finalPoints;
                                const mainCut = cutoffData.main;
                                const qualCut = cutoffData.qual;

                                // 1. Mandatory (Top 10 & Super 1000/750)
                                if (sim.currentRank && sim.currentRank <= 10 && (tournament.shortGrade.includes('S1000') || tournament.shortGrade.includes('S750'))) {
                                    statusKey = 'mandatory';
                                    prediction = t('mandatory');
                                    diff = userPts - mainCut;
                                }
                                // 2. Main Draw Safe (Green)
                                else if (userPts >= mainCut) {
                                    statusKey = 'main';
                                    prediction = t('mainSafe');
                                    diff = userPts - mainCut;
                                }
                                // 3. Qualifying / Reserve (Yellow) -> Check Qualifying Cutoff
                                else if (qualCut !== null && userPts >= qualCut) {
                                    statusKey = 'qual'; // Yellow
                                    prediction = "Target: Qualifying Round"; // Explicit Text Request
                                    diff = userPts - qualCut;
                                    // Optional logic: "Reserve" if close to Qual cutoff?
                                    // User logic: "User Points < t.cutoff AND User Points >= t.qualCutoff" -> Yellow
                                }
                                // 4. Rank too low (Red)
                                else {
                                    statusKey = 'reserve'; // Red
                                    const target = qualCut !== null ? qualCut : mainCut;
                                    diff = userPts - target;
                                    prediction = `${t('reserve')} (${diff.toLocaleString()})`;
                                }

                                // Append cutoff info to prediction for clarity
                                // Show Main Cutoff always, add Qual if relevant?
                                let cutoffDisplay = ` (Main: ${mainCut.toLocaleString()}`;
                                if (qualCut) cutoffDisplay += ` / Qual: ${qualCut.toLocaleString()}`;
                                cutoffDisplay += `)`;

                                prediction += cutoffDisplay;

                                // Opportunity flag
                                const isOpportunity = ['Asia-West', 'Asia-Central', 'PanAm-North', 'PanAm-South', 'Oceania', 'Africa'].includes(subRegion);
                                if (isOpportunity) {
                                    prediction += ' üìâ'; // Opportunity icon
                                }

                                // ‚úÖ NEW: Add unique ID for selection
                                const id = `${tournament.name}-${tournament.startIso}`;
                                return {
                                    ...tournament,
                                    id,
                                    prediction,
                                    diff,
                                    statusKey,
                                    subRegion,
                                    region: regionInfo.region,
                                    isOpportunity,
                                    mainCutoff: mainCut,
                                    qualCutoff: qualCut
                                };
                            }).sort((a, b) => a.startIso.localeCompare(b.startIso));

                            sim.loading = false;
                            console.log('‚úÖ Simulation Complete. Results:', sim.results.length);
                        }, 800);
                    };

                    // Toggle grade filter
                    const toggleGradeFilter = (grade) => {
                        const index = filters.selectedGrades.indexOf(grade);
                        if (index > -1) {
                            filters.selectedGrades.splice(index, 1);
                        } else {
                            filters.selectedGrades.push(grade);
                        }
                    };

                    // Toggle region filter
                    const toggleRegionFilter = (region) => {
                        const index = filters.selectedRegions.indexOf(region);
                        if (index > -1) {
                            filters.selectedRegions.splice(index, 1);
                        } else {
                            filters.selectedRegions.push(region);
                        }
                    };

                    // Map tournament region based on country
                    const getTournamentRegion = (country) => {
                        if (!country) return { region: 'Asia', subRegion: 'Asia-East' }; // Default

                        const countryUpper = country.toUpperCase();

                        // ‚úÖ Sub-Region Map
                        const subRegionMap = {
                            // Asia
                            'Asia-East': ['CHINA', 'JAPAN', 'KOREA', 'CHINESE TAIPEI', 'HONG KONG', 'MACAU', 'MONGOLIA'],
                            'Asia-SE': ['INDONESIA', 'MALAYSIA', 'THAILAND', 'SINGAPORE', 'VIETNAM', 'PHILIPPINES', 'CAMBODIA', 'LAOS', 'BRUNEI', 'TIMOR-LESTE', 'MYANMAR'],
                            'Asia-South': ['INDIA', 'SRI LANKA', 'MALDIVES', 'NEPAL', 'BANGLADESH', 'PAKISTAN', 'AFGHANISTAN', 'BHUTAN'],
                            'Asia-West': ['BAHRAIN', 'UAE', 'UNITED ARAB EMIRATES', 'SAUDI ARABIA', 'QATAR', 'JORDAN', 'LEBANON', 'SYRIA', 'IRAQ', 'KUWAIT', 'OMAN', 'YEMEN', 'IRAN', 'PALESTINE', 'ISRAEL'],
                            'Asia-Central': ['KAZAKHSTAN', 'UZBEKISTAN', 'TAJIKISTAN', 'KYRGYZSTAN', 'TURKMENISTAN'],

                            // Europe (Split into West/South/North/East if needed, but keeping simple for now based on user request "Zone B")
                            'Europe': ['DENMARK', 'ENGLAND', 'Great Britain', 'FRANCE', 'GERMANY', 'SPAIN', 'SWITZERLAND', 'NETHERLANDS', 'SWEDEN', 'ITALY', 'RUSSIA', 'POLAND', 'CZECHIA', 'CZECH REPUBLIC', 'UKRAINE', 'BELGIUM', 'AUSTRIA', 'IRELAND', 'SCOTLAND', 'WALES', 'FINLAND', 'NORWAY', 'PORTUGAL', 'GREECE', 'BULGARIA', 'ESTONIA', 'LATVIA', 'LITHUANIA', 'HUNGARY', 'SLOVAKIA', 'SLOVENIA', 'CROATIA', 'SERBIA', 'BOSNIA', 'ROMANIA', 'MOLDOVA', 'TURKIYE', 'TURKEY', 'CYPRUS', 'MALTA', 'ICELAND', 'LUXEMBOURG', 'AZERBAIJAN', 'ARMENIA', 'GEORGIA', 'BELARUS', 'FAROE ISLANDS'],

                            // Americas
                            'PanAm-North': ['USA', 'U.S.A.', 'CANADA', 'MEXICO'],
                            'PanAm-South': ['BRAZIL', 'ARGENTINA', 'CHILE', 'PERU', 'COLOMBIA', 'GUATEMALA', 'EL SALVADOR', 'CUBA', 'JAMAICA', 'DOMINICAN REPUBLIC', 'BARBADOS', 'TRINIDAD', 'TOBAGO', 'SURINAME', 'GUYANA', 'VENEZUELA', 'ECUADOR', 'BOLIVIA', 'PARAGUAY', 'URUGUAY', 'COSTA RICA', 'PANAMA', 'HONDURAS', 'NICARAGUA', 'BELIZE', 'HAITI', 'BAHAMAS', 'BERMUDA', 'CAYMAN ISLANDS', 'GREENLAND', 'FALKLAND ISLANDS'],

                            // Africa
                            'Africa': ['EGYPT', 'SOUTH AFRICA', 'ALGERIA', 'NIGERIA', 'MAURITIUS', 'ZIMBABWE', 'UGANDA', 'ZAMBIA', 'KENYA', 'GHANA', 'CAMEROON', 'MOROCCO', 'TUNISIA', 'BOTSWANA', 'NAMIBIA', 'MOZAMBIQUE', 'MADAGASCAR', 'SEYCHELLES', 'ETHIOPIA', 'TANZANIA', 'IVORY COAST', 'BENIN', 'TOGO', 'BURKINA FASO', 'SENEGAL', 'CONGO', 'MALI', 'GABON', 'REUNION'],

                            // Oceania
                            'Oceania': ['AUSTRALIA', 'NEW ZEALAND', 'FIJI', 'NEW CALEDONIA', 'TAHITI', 'SAMOA', 'TUVALU', 'KIRIBATI', 'TONGA', 'GUAM', 'COOK ISLANDS', 'NORFOLK ISLAND', 'NORTHERN MARIANA ISLANDS', 'PAPUA NEW GUINEA']
                        };

                        for (const [subRegion, countries] of Object.entries(subRegionMap)) {
                            if (countries.some(c => countryUpper.includes(c))) {
                                let mainRegion = 'Asia';
                                if (subRegion.includes('Europe')) mainRegion = 'Europe';
                                if (subRegion.includes('PanAm')) mainRegion = 'PanAm';
                                if (subRegion.includes('Africa')) mainRegion = 'Africa';
                                if (subRegion.includes('Oceania')) mainRegion = 'Oceania';
                                return { region: mainRegion, subRegion };
                            }
                        }
                        return { region: 'Asia', subRegion: 'Asia-East' }; // Default
                    };

                    const filteredResults = computed(() => {
                        if (!sim.results) return [];

                        return sim.results.filter(tournament => {
                            // Region filter (Main Region)
                            if (filters.selectedRegions.length > 0) {
                                if (!filters.selectedRegions.includes(tournament.region)) return false;
                            }

                            // Check if it is a Junior tournament
                            const grade = (tournament.grade || '').toLowerCase();
                            const name = (tournament.name || '').toLowerCase();
                            const isJunior = grade.includes('junior') || name.includes('junior') ||
                                grade.includes('u19') || name.includes('u19') ||
                                grade.includes('u17') || name.includes('u17') ||
                                grade.includes('u15') || name.includes('u15') ||
                                grade.includes('u13') || name.includes('u13') ||
                                grade.includes('youth');

                            // ‚úÖ Junior Logic: 
                            // If 'Junior' filter is NOT active, HIDE all Junior tournaments (default behavior)
                            if (!filters.selectedGrades.includes('Junior') && isJunior) return false;

                            // Grade filter
                            if (filters.selectedGrades.length > 0) {
                                // If 'Junior' is active and this IS a Junior tournament, SHOW it.
                                if (isJunior && filters.selectedGrades.includes('Junior')) return true;

                                // For non-Junior tournaments, check other grades
                                // We filter out 'Junior' from the checking list so it doesn't match 'Junior' string in non-junior grades (if any)
                                const otherGrades = filters.selectedGrades.filter(g => g !== 'Junior');

                                if (otherGrades.length > 0) {
                                    const hasMatchingGrade = otherGrades.some(grade => {
                                        // ‚úÖ FIX: Stricter matching to prevent S100 from matching S1000
                                        // Split shortGrade by space or analyze it
                                        const tGrade = tournament.shortGrade;

                                        if (grade === 'S100') {
                                            // Ensure it ends with 100 and not followed by another digit (like 0 in 1000)
                                            // or check equality if shortGrade is just "S100"
                                            return tGrade === 'S100' || tGrade.includes('S100 ') || tGrade.endsWith('S100');
                                        }
                                        if (grade === 'S300') return tGrade.includes('S300'); // S300 doesn't have S3000
                                        if (grade === 'S500') return tGrade.includes('S500');
                                        if (grade === 'S750') return tGrade.includes('S750');
                                        if (grade === 'S1000') return tGrade.includes('S1000');

                                        return tGrade.includes(grade);
                                    });
                                    if (!hasMatchingGrade) return false;
                                } else {
                                    // If ONLY 'Junior' is selected, and this is NOT a Junior tournament -> Hide it
                                    return false;
                                }
                            }

                            return true;
                        });
                    });

                    const shareResults = () => {
                        const params = new URLSearchParams();
                        params.set('type', sim.type);
                        params.set('event', sim.guestEvent);
                        if (sim.guestPoints) params.set('pts', sim.guestPoints);
                        if (sim.currentRank) params.set('rank', sim.currentRank);
                        if (sim.type === 'doubles') {
                            if (sim.partnerPoints) params.set('ppts', sim.partnerPoints);
                            params.set('method', sim.calcMethod);
                            if (sim.calcMethod === 'adjusted') params.set('cnt', sim.playedCount);
                        }
                        const url = `${window.location.origin}${window.location.pathname}?${params.toString()}`;

                        if (navigator.share) {
                            navigator.share({
                                title: 'Court Mate Prediction',
                                text: 'Check out my tournament entry forecast!',
                                url: url
                            }).catch(console.error);
                        }
                        else {
                            navigator.clipboard.writeText(url)
                                .then(() => alert('Link copied to clipboard!'))
                                .catch(() => prompt("Copy link:", url));
                        }
                    };

                    const copyEmail = () => {
                        const email = 'roumsne@gmail.com';
                        navigator.clipboard.writeText(email)
                            .then(() => {
                                alert('Email copied to clipboard!\n' + email);
                            })
                            .catch((err) => {
                                console.error('Failed to copy email:', err);
                                alert('Failed to copy email. Please copy manually: ' + email);
                            });
                    };

                    const copyAgentEmail = () => {
                        const email = 'withm2k@gmail.com';
                        navigator.clipboard.writeText(email)
                            .then(() => {
                                alert('Agent email copied to clipboard!\n' + email);
                            })
                            .catch((err) => {
                                console.error('Failed to copy email:', err);
                                alert('Failed to copy email. Please copy manually: ' + email);
                            });
                    };

                    const checkUrlParams = () => {
                        const params = new URLSearchParams(window.location.search);
                        if (params.has('event')) {
                            sim.type = params.get('type') || 'singles';
                            sim.guestEvent = params.get('event');
                            if (params.has('pts')) sim.guestPoints = Number(params.get('pts'));
                            if (params.has('rank')) sim.currentRank = Number(params.get('rank'));
                            if (sim.type === 'doubles') {
                                if (params.has('ppts')) sim.partnerPoints = Number(params.get('ppts'));
                                if (params.has('method')) sim.calcMethod = params.get('method');
                                if (params.has('cnt')) sim.playedCount = params.get('cnt');
                            }
                            if (sim.guestPoints) runSimulation();
                        }
                    };

                    // ‚úÖ Ï∂îÍ∞Ä: ÏÜåÏÖú ÎØ∏ÎîîÏñ¥ Ïó¥Í∏∞ Ìï®Ïàò
                    const openSocial = (platform) => {
                        // Ïã§Ï†ú ÏÑúÎπÑÏä§ÏóêÏÑúÎäî Ïó¨Í∏∞Ïóê Îî•ÎßÅÌÅ¨ÎÇò URLÏùÑ Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî
                        const links = {
                            wechat: 'weixin://',
                            kakao: 'kakaotalk://',
                            line: 'line://'
                        };

                        if (links[platform]) {
                            window.location.href = links[platform];
                        } else {
                            alert(`Open ${platform}`);
                        }
                    };

                    // Toggle Dark Mode
                    const toggleDarkMode = () => {
                        darkMode.value = !darkMode.value;
                        if (darkMode.value) {
                            document.body.classList.add('dark-mode');
                            localStorage.setItem('darkMode', 'true');
                        } else {
                            document.body.classList.remove('dark-mode');
                            localStorage.setItem('darkMode', 'false');
                        }
                    };

                    // ‚úÖ Ï∂îÍ∞Ä: Í≤ÄÏÉâÏ∞Ω Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ï≤òÎ¶¨
                    onMounted(() => {
                        // Load dark mode preference
                        const savedDarkMode = localStorage.getItem('darkMode');
                        if (savedDarkMode === 'true') {
                            darkMode.value = true;
                            document.body.classList.add('dark-mode');
                        }

                        document.documentElement.lang = currentLang.value;

                        // ‚úÖ NEW: Load Remembered Player
                        const savedRememberMe = localStorage.getItem('courtmate_remember_me');
                        if (savedRememberMe === 'true') {
                            rememberPlayer.value = true;
                            const savedPlayerData = localStorage.getItem('courtmate_saved_player');
                            if (savedPlayerData) {
                                try {
                                    const parsedPlayer = JSON.parse(savedPlayerData);
                                    // We need to re-select this player
                                    // But selectPlayer expects a player object from the list or similar structure
                                    // parsedPlayer should have everything we need
                                    selectPlayer(parsedPlayer);
                                    selectedPlayer.value = parsedPlayer; // Ensure state is synced
                                } catch (e) {
                                    console.error("Failed to parse saved player data", e);
                                }
                            }
                        } else {
                            rememberPlayer.value = false;
                        }

                        // ‚úÖ NEW: Load Saved Points (Overwrite player defaults if exists)
                        if (rememberPlayer.value) {
                            const savedPoints = localStorage.getItem('courtmate_saved_points');
                            if (savedPoints) {
                                sim.guestPoints = Number(savedPoints);
                            }
                        }

                        checkUrlParams();

                        // Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Í≤ÄÏÉâ Í≤∞Í≥º Îã´Í∏∞
                        document.addEventListener('click', (e) => {
                            const searchContainer = e.target.closest('.mb-4.relative');
                            if (!searchContainer && showSearchResults.value) {
                                showSearchResults.value = false;
                            }
                        });
                    });

                    // ‚úÖ NEW: Watch for Language Changes
                    watch(currentLang, (newLang) => {
                        localStorage.setItem('courtmate_lang', newLang);
                        document.documentElement.lang = newLang;
                    });

                    // ‚úÖ NEW: Watch for Points Changes to Save
                    watch(() => sim.guestPoints, (newPoints) => {
                        if (rememberPlayer.value) {
                            localStorage.setItem('courtmate_saved_points', newPoints);
                        }
                    });

                    // Update rememberPlayer watcher to also save points immediately
                    watch(rememberPlayer, (newVal) => {
                        localStorage.setItem('courtmate_remember_me', newVal ? 'true' : 'false');
                        if (newVal) {
                            if (selectedPlayer.value) {
                                const playerToSave = { ...selectedPlayer.value, points: typeof selectedPlayer.value.points === 'string' ? selectedPlayer.value.points : selectedPlayer.value.points.toString() };
                                localStorage.setItem('courtmate_saved_player', JSON.stringify(playerToSave));
                            }
                            // Also save current points
                            if (sim.guestPoints) {
                                localStorage.setItem('courtmate_saved_points', sim.guestPoints);
                            }
                        } else {
                            localStorage.removeItem('courtmate_saved_player');
                            localStorage.removeItem('courtmate_saved_points');
                        }
                    });

                    // ‚úÖ NEW: Helper for M&Q Date Urgent Check
                    const isUrgentMq = (dateStr) => {
                        if (!dateStr || dateStr === 'TBA') return false;
                        const now = new Date();
                        const target = new Date(dateStr);
                        now.setHours(0, 0, 0, 0);
                        target.setHours(0, 0, 0, 0);

                        const diffTime = target - now;
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                        // Today (0) or Tomorrow (1)
                        return diffDays === 0 || diffDays === 1;
                    };

                    // ‚úÖ NEW: Generate Trip.com Affiliate Link with Pre-filled Dates
                    const getTripLink = (type, tournament) => {
                        const startDate = new Date(tournament.startIso);
                        const endDate = new Date(tournament.endIso);

                        // Arrival Date = Start Date - 2 Days
                        const arrivalDate = new Date(startDate);
                        arrivalDate.setDate(startDate.getDate() - 2);

                        // Departure Date = End Date
                        const departureDate = endDate;

                        const formatDate = (date) => date.toISOString().split('T')[0];
                        const arrivalStr = formatDate(arrivalDate);
                        const departureStr = formatDate(departureDate);

                        const links = {
                            flight: 'https://www.trip.com/t/vcoZRUY5UT2',
                            hotel: 'https://www.trip.com/t/d8z1woX5UT2',
                            package: 'https://www.trip.com/t/DjdaZlb9UT2',
                            pickup: 'https://www.trip.com/t/wP4ARpU5UT2'
                        };

                        let url = links[type] || links.flight;
                        const params = new URLSearchParams();

                        if (type === 'flight' || type === 'package') {
                            params.append('dDate', arrivalStr);
                            params.append('rDate', departureStr);
                        }
                        if (type === 'hotel' || type === 'package') {
                            params.append('checkIn', arrivalStr);
                            params.append('checkOut', departureStr);
                        }
                        // Pickup often uses flight arrival date
                        if (type === 'pickup') {
                            params.append('date', arrivalStr);
                        }

                        return `${url}?${params.toString()}`;
                    };



                    return {
                        currentLang,
                        t,
                        showConsultModal,
                        showNoticeModal, // ‚úÖ NEW: Export Notice Modal State
                        sim,
                        runSimulation,
                        filteredResults,

                        shareResults,
                        copyEmail,
                        copyAgentEmail,
                        searchQuery,
                        showSearchResults,
                        searchResults,
                        selectPlayer,
                        clearSearch,
                        formatPoints,
                        dataLoadError,
                        validationErrors,
                        validateInputs,
                        isFormValid,
                        openSocial,
                        getValidationMessage,
                        // ‚úÖ NEW: Export new state variables
                        filters,
                        timerState,

                        playerNationality,
                        loadingLogs,
                        loadingProgress,
                        darkMode,
                        toggleDarkMode,
                        toggleGradeFilter,
                        toggleRegionFilter,
                        showPhoneNumber, // ‚úÖ NEW: Export Phone State
                        togglePhone,     // ‚úÖ NEW: Export Phone Toggle
                        isUrgentMq,      // ‚úÖ NEW: Export Helper
                        getTripLink,     // ‚úÖ NEW: Export Link Generator


                    };
                }
            }).mount('#app');
        });
    </script>
</body>

</html>